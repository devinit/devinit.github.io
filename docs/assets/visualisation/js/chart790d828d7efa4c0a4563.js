(self.webpackChunkdi_website=self.webpackChunkdi_website||[]).push([[3170],{87401:(t,i,e)=>{var o=e(18057),r=e(72645),s=r("../shaders/vertex.glsl"),n=r("../shaders/fragment.glsl"),a=r("../shaders/contour-vertex.glsl"),h=r("../shaders/pick.glsl");i.createShader=function(t){var i=o(t,s,n,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return i.attributes.uv.location=0,i.attributes.f.location=1,i.attributes.normal.location=2,i},i.createPickShader=function(t){var i=o(t,s,h,null,[{name:"uv",type:"vec4"},{name:"f",type:"vec3"},{name:"normal",type:"vec3"}]);return i.attributes.uv.location=0,i.attributes.f.location=1,i.attributes.normal.location=2,i},i.createContourShader=function(t){var i=o(t,a,n,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return i.attributes.uv.location=0,i.attributes.f.location=1,i},i.createPickContourShader=function(t){var i=o(t,a,h,null,[{name:"uv",type:"vec4"},{name:"f",type:"float"}]);return i.attributes.uv.location=0,i.attributes.f.location=1,i}},4933:(t,i,e)=>{"use strict";t.exports=function(t){var i=t.gl,e=y(i),o=b(i),a=_(i),h=x(i),l=r(i),u=s(i,[{buffer:l,size:4,stride:40,offset:0},{buffer:l,size:3,stride:40,offset:16},{buffer:l,size:3,stride:40,offset:28}]),c=r(i),f=s(i,[{buffer:c,size:4,stride:20,offset:0},{buffer:c,size:1,stride:20,offset:16}]),d=r(i),p=s(i,[{buffer:d,size:2,type:i.FLOAT}]),v=n(i,1,256,i.RGBA,i.UNSIGNED_BYTE);v.minFilter=i.LINEAR,v.magFilter=i.LINEAR;var g=new L(i,[0,0],[[0,0,0],[0,0,0]],e,o,l,u,v,a,h,c,f,d,p,[0,0,0]),m={levels:[[],[],[]]};for(var w in t)m[w]=t[w];return m.colormap=m.colormap||"jet",g.update(m),g};var o=e(746),r=e(28580),s=e(24324),n=e(86753),a=e(90316),h=e(60800),l=e(38897),u=e(21943),c=e(62861),f=e(86068),d=e(29401),p=e(64481),v=e(73076),g=e(86973),m=e(87401),y=m.createShader,_=m.createContourShader,b=m.createPickShader,x=m.createPickContourShader,w=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],C=[[0,0],[0,1],[1,0],[1,1],[1,0],[0,1]],j=[[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0]];function S(t,i,e,o,r){this.position=t,this.index=i,this.uv=e,this.level=o,this.dataCoordinate=r}function L(t,i,e,o,r,s,n,h,l,u,f,d,p,v,g){this.gl=t,this.shape=i,this.bounds=e,this.objectOffset=g,this.intensityBounds=[],this._shader=o,this._pickShader=r,this._coordinateBuffer=s,this._vao=n,this._colorMap=h,this._contourShader=l,this._contourPickShader=u,this._contourBuffer=f,this._contourVAO=d,this._contourOffsets=[[],[],[]],this._contourCounts=[[],[],[]],this._vertexCount=0,this._pickResult=new S([0,0,0],[0,0],[0,0],[0,0,0],[0,0,0]),this._dynamicBuffer=p,this._dynamicVAO=v,this._dynamicOffsets=[0,0,0],this._dynamicCounts=[0,0,0],this.contourWidth=[1,1,1],this.contourLevels=[[1],[1],[1]],this.contourTint=[0,0,0],this.contourColor=[[.5,.5,.5,1],[.5,.5,.5,1],[.5,.5,.5,1]],this.showContour=!0,this.showSurface=!0,this.enableHighlight=[!0,!0,!0],this.highlightColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.highlightTint=[1,1,1],this.highlightLevel=[-1,-1,-1],this.enableDynamic=[!0,!0,!0],this.dynamicLevel=[NaN,NaN,NaN],this.dynamicColor=[[0,0,0,1],[0,0,0,1],[0,0,0,1]],this.dynamicTint=[1,1,1],this.dynamicWidth=[1,1,1],this.axesBounds=[[1/0,1/0,1/0],[-1/0,-1/0,-1/0]],this.surfaceProject=[!1,!1,!1],this.contourProject=[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],this.colorBounds=[!1,!1],this._field=[c(a.mallocFloat(1024),[0,0]),c(a.mallocFloat(1024),[0,0]),c(a.mallocFloat(1024),[0,0])],this.pickId=1,this.clipBounds=[[-1/0,-1/0,-1/0],[1/0,1/0,1/0]],this.snapToData=!1,this.pixelRatio=1,this.opacity=1,this.opacityscale=!1,this.lightPosition=[10,1e4,0],this.ambientLight=.8,this.diffuseLight=.8,this.specularLight=2,this.roughness=.5,this.fresnel=1.5,this.vertexColor=0,this.dirty=!0}!function(){for(var t=0;t<3;++t){var i=j[t],e=(t+2)%3;i[(t+1)%3+0]=1,i[e+3]=1,i[t+6]=1}}();var M=L.prototype;M.isTransparent=function(){return this.opacity<1||this.opacityscale},M.isOpaque=function(){if(this.opacityscale)return!1;if(this.opacity<1)return!1;if(this.opacity>=1)return!0;for(var t=0;t<3;++t)if(this._contourCounts[t].length>0)return!0;return!1},M.pickSlots=1,M.setPickBase=function(t){this.pickId=t};var B=[0,0,0],k={showSurface:!1,showContour:!1,projections:[w.slice(),w.slice(),w.slice()],clipBounds:[[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]],[[0,0,0],[0,0,0]]]};function A(t,i){var e,o,r,s=i.axes&&i.axes.lastCubeProps.axis||B,n=i.showSurface,a=i.showContour;for(e=0;e<3;++e)for(n=n||i.surfaceProject[e],o=0;o<3;++o)a=a||i.contourProject[e][o];for(e=0;e<3;++e){var h=k.projections[e];for(o=0;o<16;++o)h[o]=0;for(o=0;o<4;++o)h[5*o]=1;h[5*e]=0,h[12+e]=i.axesBounds[+(s[e]>0)][e],d(h,t.model,h);var l=k.clipBounds[e];for(r=0;r<2;++r)for(o=0;o<3;++o)l[r][o]=t.clipBounds[r][o];l[0][e]=-1e8,l[1][e]=1e8}return k.showSurface=n,k.showContour=a,k}var O={model:w,view:w,projection:w,inverseModel:w.slice(),lowerBound:[0,0,0],upperBound:[0,0,0],colorMap:0,clipBounds:[[0,0,0],[0,0,0]],height:0,contourTint:0,contourColor:[0,0,0,1],permutation:[1,0,0,0,1,0,0,0,1],zOffset:-1e-4,objectOffset:[0,0,0],kambient:1,kdiffuse:1,kspecular:1,lightPosition:[1e3,1e3,1e3],eyePosition:[0,0,0],roughness:1,fresnel:1,opacity:1,vertexColor:0},z=w.slice(),N=[1,0,0,0,1,0,0,0,1];function T(t,i){t=t||{};var e=this.gl;e.disable(e.CULL_FACE),this._colorMap.bind(0);var o=O;o.model=t.model||w,o.view=t.view||w,o.projection=t.projection||w,o.lowerBound=[this.bounds[0][0],this.bounds[0][1],this.colorBounds[0]||this.bounds[0][2]],o.upperBound=[this.bounds[1][0],this.bounds[1][1],this.colorBounds[1]||this.bounds[1][2]],o.objectOffset=this.objectOffset,o.contourColor=this.contourColor[0],o.inverseModel=p(o.inverseModel,o.model);for(var r=0;r<2;++r)for(var s=o.clipBounds[r],n=0;n<3;++n)s[n]=Math.min(Math.max(this.clipBounds[r][n],-1e8),1e8);o.kambient=this.ambientLight,o.kdiffuse=this.diffuseLight,o.kspecular=this.specularLight,o.roughness=this.roughness,o.fresnel=this.fresnel,o.opacity=this.opacity,o.height=0,o.permutation=N,o.vertexColor=this.vertexColor;var a=z;for(d(a,o.view,o.model),d(a,o.projection,a),p(a,a),r=0;r<3;++r)o.eyePosition[r]=a[12+r]/a[15];var h=a[15];for(r=0;r<3;++r)h+=this.lightPosition[r]*a[4*r+3];for(r=0;r<3;++r){var l=a[12+r];for(n=0;n<3;++n)l+=a[4*n+r]*this.lightPosition[n];o.lightPosition[r]=l/h}var u=A(o,this);if(u.showSurface){for(this._shader.bind(),this._shader.uniforms=o,this._vao.bind(),this.showSurface&&this._vertexCount&&this._vao.draw(e.TRIANGLES,this._vertexCount),r=0;r<3;++r)this.surfaceProject[r]&&this.vertexCount&&(this._shader.uniforms.model=u.projections[r],this._shader.uniforms.clipBounds=u.clipBounds[r],this._vao.draw(e.TRIANGLES,this._vertexCount));this._vao.unbind()}if(u.showContour){var c=this._contourShader;o.kambient=1,o.kdiffuse=0,o.kspecular=0,o.opacity=1,c.bind(),c.uniforms=o;var f=this._contourVAO;for(f.bind(),r=0;r<3;++r)for(c.uniforms.permutation=j[r],e.lineWidth(this.contourWidth[r]*this.pixelRatio),n=0;n<this.contourLevels[r].length;++n)n===this.highlightLevel[r]?(c.uniforms.contourColor=this.highlightColor[r],c.uniforms.contourTint=this.highlightTint[r]):0!==n&&n-1!==this.highlightLevel[r]||(c.uniforms.contourColor=this.contourColor[r],c.uniforms.contourTint=this.contourTint[r]),this._contourCounts[r][n]&&(c.uniforms.height=this.contourLevels[r][n],f.draw(e.LINES,this._contourCounts[r][n],this._contourOffsets[r][n]));for(r=0;r<3;++r)for(c.uniforms.model=u.projections[r],c.uniforms.clipBounds=u.clipBounds[r],n=0;n<3;++n)if(this.contourProject[r][n]){c.uniforms.permutation=j[n],e.lineWidth(this.contourWidth[n]*this.pixelRatio);for(var v=0;v<this.contourLevels[n].length;++v)v===this.highlightLevel[n]?(c.uniforms.contourColor=this.highlightColor[n],c.uniforms.contourTint=this.highlightTint[n]):0!==v&&v-1!==this.highlightLevel[n]||(c.uniforms.contourColor=this.contourColor[n],c.uniforms.contourTint=this.contourTint[n]),this._contourCounts[n][v]&&(c.uniforms.height=this.contourLevels[n][v],f.draw(e.LINES,this._contourCounts[n][v],this._contourOffsets[n][v]))}for(f.unbind(),(f=this._dynamicVAO).bind(),r=0;r<3;++r)if(0!==this._dynamicCounts[r])for(c.uniforms.model=o.model,c.uniforms.clipBounds=o.clipBounds,c.uniforms.permutation=j[r],e.lineWidth(this.dynamicWidth[r]*this.pixelRatio),c.uniforms.contourColor=this.dynamicColor[r],c.uniforms.contourTint=this.dynamicTint[r],c.uniforms.height=this.dynamicLevel[r],f.draw(e.LINES,this._dynamicCounts[r],this._dynamicOffsets[r]),n=0;n<3;++n)this.contourProject[n][r]&&(c.uniforms.model=u.projections[n],c.uniforms.clipBounds=u.clipBounds[n],f.draw(e.LINES,this._dynamicCounts[r],this._dynamicOffsets[r]));f.unbind()}}M.draw=function(t){return T.call(this,t,!1)},M.drawTransparent=function(t){return T.call(this,t,!0)};var P={model:w,view:w,projection:w,inverseModel:w,clipBounds:[[0,0,0],[0,0,0]],height:0,shape:[0,0],pickId:0,lowerBound:[0,0,0],upperBound:[0,0,0],zOffset:0,objectOffset:[0,0,0],permutation:[1,0,0,0,1,0,0,0,1],lightPosition:[0,0,0],eyePosition:[0,0,0]};function F(t,i){return Array.isArray(t)?[i(t[0]),i(t[1]),i(t[2])]:[i(t),i(t),i(t)]}function E(t){return Array.isArray(t)?3===t.length?[t[0],t[1],t[2],1]:[t[0],t[1],t[2],t[3]]:[0,0,0,1]}function V(t){if(Array.isArray(t)){if(Array.isArray(t))return[E(t[0]),E(t[1]),E(t[2])];var i=E(t);return[i.slice(),i.slice(),i.slice()]}}M.drawPick=function(t){t=t||{};var i=this.gl;i.disable(i.CULL_FACE);var e=P;e.model=t.model||w,e.view=t.view||w,e.projection=t.projection||w,e.shape=this._field[2].shape,e.pickId=this.pickId/255,e.lowerBound=this.bounds[0],e.upperBound=this.bounds[1],e.objectOffset=this.objectOffset,e.permutation=N;for(var o=0;o<2;++o)for(var r=e.clipBounds[o],s=0;s<3;++s)r[s]=Math.min(Math.max(this.clipBounds[o][s],-1e8),1e8);var n=A(e,this);if(n.showSurface){for(this._pickShader.bind(),this._pickShader.uniforms=e,this._vao.bind(),this._vao.draw(i.TRIANGLES,this._vertexCount),o=0;o<3;++o)this.surfaceProject[o]&&(this._pickShader.uniforms.model=n.projections[o],this._pickShader.uniforms.clipBounds=n.clipBounds[o],this._vao.draw(i.TRIANGLES,this._vertexCount));this._vao.unbind()}if(n.showContour){var a=this._contourPickShader;a.bind(),a.uniforms=e;var h=this._contourVAO;for(h.bind(),s=0;s<3;++s)for(i.lineWidth(this.contourWidth[s]*this.pixelRatio),a.uniforms.permutation=j[s],o=0;o<this.contourLevels[s].length;++o)this._contourCounts[s][o]&&(a.uniforms.height=this.contourLevels[s][o],h.draw(i.LINES,this._contourCounts[s][o],this._contourOffsets[s][o]));for(o=0;o<3;++o)for(a.uniforms.model=n.projections[o],a.uniforms.clipBounds=n.clipBounds[o],s=0;s<3;++s)if(this.contourProject[o][s]){a.uniforms.permutation=j[s],i.lineWidth(this.contourWidth[s]*this.pixelRatio);for(var l=0;l<this.contourLevels[s].length;++l)this._contourCounts[s][l]&&(a.uniforms.height=this.contourLevels[s][l],h.draw(i.LINES,this._contourCounts[s][l],this._contourOffsets[s][l]))}h.unbind()}},M.pick=function(t){if(!t)return null;if(t.id!==this.pickId)return null;var i=this._field[2].shape,e=this._pickResult,o=i[0]*(t.value[0]+(t.value[2]>>4)/16)/255,r=Math.floor(o),s=o-r,n=i[1]*(t.value[1]+(15&t.value[2])/16)/255,a=Math.floor(n),h=n-a;r+=1,a+=1;var l=e.position;l[0]=l[1]=l[2]=0;for(var u=0;u<2;++u)for(var c=u?s:1-s,f=0;f<2;++f)for(var d=r+u,p=a+f,g=c*(f?h:1-h),m=0;m<3;++m)l[m]+=this._field[m].get(d,p)*g;for(var y=this._pickResult.level,_=0;_<3;++_)if(y[_]=v.le(this.contourLevels[_],l[_]),y[_]<0)this.contourLevels[_].length>0&&(y[_]=0);else if(y[_]<this.contourLevels[_].length-1){var b=this.contourLevels[_][y[_]],x=this.contourLevels[_][y[_]+1];Math.abs(b-l[_])>Math.abs(x-l[_])&&(y[_]+=1)}for(e.index[0]=s<.5?r:r+1,e.index[1]=h<.5?a:a+1,e.uv[0]=o/i[0],e.uv[1]=n/i[1],m=0;m<3;++m)e.dataCoordinate[m]=this._field[m].get(e.index[0],e.index[1]);return e},M.padField=function(t,i){var e=i.shape.slice(),o=t.shape.slice();l.assign(t.lo(1,1).hi(e[0],e[1]),i),l.assign(t.lo(1).hi(e[0],1),i.hi(e[0],1)),l.assign(t.lo(1,o[1]-1).hi(e[0],1),i.lo(0,e[1]-1).hi(e[0],1)),l.assign(t.lo(0,1).hi(1,e[1]),i.hi(1)),l.assign(t.lo(o[0]-1,1).hi(1,e[1]),i.lo(e[0]-1)),t.set(0,0,i.get(0,0)),t.set(0,o[1]-1,i.get(0,e[1]-1)),t.set(o[0]-1,0,i.get(e[0]-1,0)),t.set(o[0]-1,o[1]-1,i.get(e[0]-1,e[1]-1))},M.update=function(t){t=t||{},this.objectOffset=t.objectOffset||this.objectOffset,this.dirty=!0,"contourWidth"in t&&(this.contourWidth=F(t.contourWidth,Number)),"showContour"in t&&(this.showContour=F(t.showContour,Boolean)),"showSurface"in t&&(this.showSurface=!!t.showSurface),"contourTint"in t&&(this.contourTint=F(t.contourTint,Boolean)),"contourColor"in t&&(this.contourColor=V(t.contourColor)),"contourProject"in t&&(this.contourProject=F(t.contourProject,(function(t){return F(t,Boolean)}))),"surfaceProject"in t&&(this.surfaceProject=t.surfaceProject),"dynamicColor"in t&&(this.dynamicColor=V(t.dynamicColor)),"dynamicTint"in t&&(this.dynamicTint=F(t.dynamicTint,Number)),"dynamicWidth"in t&&(this.dynamicWidth=F(t.dynamicWidth,Number)),"opacity"in t&&(this.opacity=t.opacity),"opacityscale"in t&&(this.opacityscale=t.opacityscale),"colorBounds"in t&&(this.colorBounds=t.colorBounds),"vertexColor"in t&&(this.vertexColor=t.vertexColor?1:0);var i=t.field||t.coords&&t.coords[2]||null,e=!1;if(i||(i=this._field[2].shape[0]||this._field[2].shape[2]?this._field[2].lo(1,1).hi(this._field[2].shape[0]-2,this._field[2].shape[1]-2):this._field[2].hi(0,0)),"field"in t||"coords"in t){var r=(i.shape[0]+2)*(i.shape[1]+2);r>this._field[2].data.length&&(a.freeFloat(this._field[2].data),this._field[2].data=a.mallocFloat(o.nextPow2(r))),this._field[2]=c(this._field[2].data,[i.shape[0]+2,i.shape[1]+2]),this.padField(this._field[2],i),this.shape=i.shape.slice();for(var s=this.shape,n=0;n<2;++n)this._field[2].size>this._field[n].data.length&&(a.freeFloat(this._field[n].data),this._field[n].data=a.mallocFloat(this._field[2].size)),this._field[n]=c(this._field[n].data,[s[0]+2,s[1]+2]);if(t.coords){var d=t.coords;if(!Array.isArray(d)||3!==d.length)throw new Error("gl-surface: invalid coordinates for x/y");for(n=0;n<2;++n){var p=d[n];for(b=0;b<2;++b)if(p.shape[b]!==s[b])throw new Error("gl-surface: coords have incorrect shape");this.padField(this._field[n],p)}}else if(t.ticks){var v=t.ticks;if(!Array.isArray(v)||2!==v.length)throw new Error("gl-surface: invalid ticks");for(n=0;n<2;++n){var m=v[n];if((Array.isArray(m)||m.length)&&(m=c(m)),m.shape[0]!==s[n])throw new Error("gl-surface: invalid tick length");var y=c(m.data,s);y.stride[n]=m.stride[0],y.stride[1^n]=0,this.padField(this._field[n],y)}}else{for(n=0;n<2;++n){var _=[0,0];_[n]=1,this._field[n]=c(this._field[n].data,[s[0]+2,s[1]+2],_,0)}this._field[0].set(0,0,0);for(var b=0;b<s[0];++b)this._field[0].set(b+1,0,b);for(this._field[0].set(s[0]+1,0,s[0]-1),this._field[1].set(0,0,0),b=0;b<s[1];++b)this._field[1].set(0,b+1,b);this._field[1].set(0,s[1]+1,s[1]-1)}var x=this._field,w=c(a.mallocFloat(3*x[2].size*2),[3,s[0]+2,s[1]+2,2]);for(n=0;n<3;++n)g(w.pick(n),x[n],"mirror");var j=c(a.mallocFloat(3*x[2].size),[s[0]+2,s[1]+2,3]);for(n=0;n<s[0]+2;++n)for(b=0;b<s[1]+2;++b){var S=w.get(0,n,b,0),L=w.get(0,n,b,1),M=w.get(1,n,b,0),B=w.get(1,n,b,1),k=w.get(2,n,b,0),A=w.get(2,n,b,1),O=M*A-B*k,z=k*L-A*S,N=S*B-L*M,T=Math.sqrt(O*O+z*z+N*N);T<1e-8?(T=Math.max(Math.abs(O),Math.abs(z),Math.abs(N)))<1e-8?(N=1,z=O=0,T=1):T=1/T:T=1/Math.sqrt(T),j.set(n,b,0,O*T),j.set(n,b,1,z*T),j.set(n,b,2,N*T)}a.free(w.data);var P=[1/0,1/0,1/0],E=[-1/0,-1/0,-1/0],D=1/0,I=-1/0,W=(s[0]-1)*(s[1]-1)*6,R=a.mallocFloat(o.nextPow2(10*W)),Y=0,X=0;for(n=0;n<s[0]-1;++n)t:for(b=0;b<s[1]-1;++b){for(var Z=0;Z<2;++Z)for(var G=0;G<2;++G)for(var q=0;q<3;++q){var H=this._field[q].get(1+n+Z,1+b+G);if(isNaN(H)||!isFinite(H))continue t}for(q=0;q<6;++q){var U=n+C[q][0],J=b+C[q][1],K=this._field[0].get(U+1,J+1),Q=this._field[1].get(U+1,J+1);H=this._field[2].get(U+1,J+1),O=j.get(U+1,J+1,0),z=j.get(U+1,J+1,1),N=j.get(U+1,J+1,2),t.intensity&&($=t.intensity.get(U,J));var $=t.intensity?t.intensity.get(U,J):H+this.objectOffset[2];R[Y++]=U,R[Y++]=J,R[Y++]=K,R[Y++]=Q,R[Y++]=H,R[Y++]=0,R[Y++]=$,R[Y++]=O,R[Y++]=z,R[Y++]=N,P[0]=Math.min(P[0],K+this.objectOffset[0]),P[1]=Math.min(P[1],Q+this.objectOffset[1]),P[2]=Math.min(P[2],H+this.objectOffset[2]),D=Math.min(D,$),E[0]=Math.max(E[0],K+this.objectOffset[0]),E[1]=Math.max(E[1],Q+this.objectOffset[1]),E[2]=Math.max(E[2],H+this.objectOffset[2]),I=Math.max(I,$),X+=1}}for(t.intensityBounds&&(D=+t.intensityBounds[0],I=+t.intensityBounds[1]),n=6;n<Y;n+=10)R[n]=(R[n]-D)/(I-D);this._vertexCount=X,this._coordinateBuffer.update(R.subarray(0,Y)),a.freeFloat(R),a.free(j.data),this.bounds=[P,E],this.intensity=t.intensity||this._field[2],this.intensityBounds[0]===D&&this.intensityBounds[1]===I||(e=!0),this.intensityBounds=[D,I]}if("levels"in t){var tt=t.levels;for(tt=Array.isArray(tt[0])?tt.slice():[[],[],tt],n=0;n<3;++n)tt[n]=tt[n].slice(),tt[n].sort((function(t,i){return t-i}));for(n=0;n<3;++n)for(b=0;b<tt[n].length;++b)tt[n][b]-=this.objectOffset[n];t:for(n=0;n<3;++n){if(tt[n].length!==this.contourLevels[n].length){e=!0;break}for(b=0;b<tt[n].length;++b)if(tt[n][b]!==this.contourLevels[n][b]){e=!0;break t}}this.contourLevels=tt}if(e){x=this._field,s=this.shape;for(var it=[],et=0;et<3;++et){var ot=this.contourLevels[et],rt=[],st=[],nt=[0,0,0];for(n=0;n<ot.length;++n){var at=f(this._field[et],ot[n]);rt.push(it.length/5|0),X=0;t:for(b=0;b<at.cells.length;++b){var ht=at.cells[b];for(q=0;q<2;++q){var lt=at.positions[ht[q]],ut=lt[0],ct=0|Math.floor(ut),ft=ut-ct,dt=lt[1],pt=0|Math.floor(dt),vt=dt-pt,gt=!1;i:for(var mt=0;mt<3;++mt){nt[mt]=0;var yt=(et+mt+1)%3;for(Z=0;Z<2;++Z){var _t=Z?ft:1-ft;for(U=0|Math.min(Math.max(ct+Z,0),s[0]),G=0;G<2;++G){var bt=G?vt:1-vt;if(J=0|Math.min(Math.max(pt+G,0),s[1]),H=mt<2?this._field[yt].get(U,J):(this.intensity.get(U,J)-this.intensityBounds[0])/(this.intensityBounds[1]-this.intensityBounds[0]),!isFinite(H)||isNaN(H)){gt=!0;break i}var xt=_t*bt;nt[mt]+=xt*H}}}if(gt){if(q>0){for(var wt=0;wt<5;++wt)it.pop();X-=1}continue t}it.push(nt[0],nt[1],lt[0],lt[1],nt[2]),X+=1}}st.push(X)}this._contourOffsets[et]=rt,this._contourCounts[et]=st}var Ct=a.mallocFloat(it.length);for(n=0;n<it.length;++n)Ct[n]=it[n];this._contourBuffer.update(Ct),a.freeFloat(Ct)}t.colormap&&this._colorMap.setPixels(function(t,i){var e=u([h({colormap:t,nshades:256,format:"rgba"}).map((function(t,e){var o=i?function(t,i){if(!i)return 1;if(!i.length)return 1;for(var e=0;e<i.length;++e){if(i.length<2)return 1;if(i[e][0]===t)return i[e][1];if(i[e][0]>t&&e>0){var o=(i[e][0]-t)/(i[e][0]-i[e-1][0]);return i[e][1]*(1-o)+o*i[e-1][1]}}return 1}(e/255,i):1;return[t[0],t[1],t[2],255*o]}))]);return l.divseq(e,255),e}(t.colormap,this.opacityscale))},M.dispose=function(){this._shader.dispose(),this._vao.dispose(),this._coordinateBuffer.dispose(),this._colorMap.dispose(),this._contourBuffer.dispose(),this._contourVAO.dispose(),this._contourShader.dispose(),this._contourPickShader.dispose(),this._dynamicBuffer.dispose(),this._dynamicVAO.dispose();for(var t=0;t<3;++t)a.freeFloat(this._field[t].data)},M.highlight=function(t){var i,e;if(!t)return this._dynamicCounts=[0,0,0],this.dyanamicLevel=[NaN,NaN,NaN],void(this.highlightLevel=[-1,-1,-1]);for(i=0;i<3;++i)this.enableHighlight[i]?this.highlightLevel[i]=t.level[i]:this.highlightLevel[i]=-1;for(e=this.snapToData?t.dataCoordinate:t.position,i=0;i<3;++i)e[i]-=this.objectOffset[i];if(this.enableDynamic[0]&&e[0]!==this.dynamicLevel[0]||this.enableDynamic[1]&&e[1]!==this.dynamicLevel[1]||this.enableDynamic[2]&&e[2]!==this.dynamicLevel[2]){for(var o=0,r=this.shape,s=a.mallocFloat(12*r[0]*r[1]),n=0;n<3;++n)if(this.enableDynamic[n]){this.dynamicLevel[n]=e[n];var h=(n+1)%3,l=(n+2)%3,u=this._field[n],c=this._field[h],d=this._field[l],p=f(u,e[n]),v=p.cells,g=p.positions;for(this._dynamicOffsets[n]=o,i=0;i<v.length;++i)for(var m=v[i],y=0;y<2;++y){var _=g[m[y]],b=+_[0],x=0|b,w=0|Math.min(x+1,r[0]),C=b-x,j=1-C,S=+_[1],L=0|S,M=0|Math.min(L+1,r[1]),B=S-L,k=1-B,A=j*k,O=j*B,z=C*k,N=C*B,T=A*c.get(x,L)+O*c.get(x,M)+z*c.get(w,L)+N*c.get(w,M),P=A*d.get(x,L)+O*d.get(x,M)+z*d.get(w,L)+N*d.get(w,M);if(isNaN(T)||isNaN(P)){y&&(o-=1);break}s[2*o+0]=T,s[2*o+1]=P,o+=1}this._dynamicCounts[n]=o-this._dynamicOffsets[n]}else this.dynamicLevel[n]=NaN,this._dynamicCounts[n]=0;this._dynamicBuffer.update(s.subarray(0,2*o)),a.freeFloat(s)}}},86973:(t,i,e)=>{"use strict";t.exports=function(t,i,e){if(Array.isArray(e)){if(e.length!==i.dimension)throw new Error("ndarray-gradient: invalid boundary conditions")}else e=o(i.dimension,"string"==typeof e?e:"clamp");if(t.dimension!==i.dimension+1)throw new Error("ndarray-gradient: output dimension must be +1 input dimension");if(t.shape[i.dimension]!==i.dimension)throw new Error("ndarray-gradient: output shape must match input shape");for(var r=0;r<i.dimension;++r)if(t.shape[r]!==i.shape[r])throw new Error("ndarray-gradient: shape mismatch");return 0===i.size?t:i.dimension<=0?(t.set(0),t):function(t){var i=t.join();if(m=n[i])return m;var e=t.length,o=["function gradient(dst,src){var s=src.shape.slice();"];function r(i){for(var r=e-i.length,s=[],n=[],a=[],h=0;h<e;++h)i.indexOf(h+1)>=0?a.push("0"):i.indexOf(-(h+1))>=0?a.push("s["+h+"]-1"):(a.push("-1"),s.push("1"),n.push("s["+h+"]-2"));var l=".lo("+s.join()+").hi("+n.join()+")";if(0===s.length&&(l=""),r>0){for(o.push("if(1"),h=0;h<e;++h)i.indexOf(h+1)>=0||i.indexOf(-(h+1))>=0||o.push("&&s[",h,"]>2");for(o.push("){grad",r,"(src.pick(",a.join(),")",l),h=0;h<e;++h)i.indexOf(h+1)>=0||i.indexOf(-(h+1))>=0||o.push(",dst.pick(",a.join(),",",h,")",l);o.push(");")}for(h=0;h<i.length;++h){var u=Math.abs(i[h])-1,c="dst.pick("+a.join()+","+u+")"+l;switch(t[u]){case"clamp":var f=a.slice(),d=a.slice();i[h]<0?f[u]="s["+u+"]-2":d[u]="1",0===r?o.push("if(s[",u,"]>1){dst.set(",a.join(),",",u,",0.5*(src.get(",f.join(),")-src.get(",d.join(),")))}else{dst.set(",a.join(),",",u,",0)};"):o.push("if(s[",u,"]>1){diff(",c,",src.pick(",f.join(),")",l,",src.pick(",d.join(),")",l,");}else{zero(",c,");};");break;case"mirror":0===r?o.push("dst.set(",a.join(),",",u,",0);"):o.push("zero(",c,");");break;case"wrap":var p=a.slice(),v=a.slice();i[h]<0?(p[u]="s["+u+"]-2",v[u]="0"):(p[u]="s["+u+"]-1",v[u]="1"),0===r?o.push("if(s[",u,"]>2){dst.set(",a.join(),",",u,",0.5*(src.get(",p.join(),")-src.get(",v.join(),")))}else{dst.set(",a.join(),",",u,",0)};"):o.push("if(s[",u,"]>2){diff(",c,",src.pick(",p.join(),")",l,",src.pick(",v.join(),")",l,");}else{zero(",c,");};");break;default:throw new Error("ndarray-gradient: Invalid boundary condition")}}r>0&&o.push("};")}for(var a=0;a<1<<e;++a){for(var c=[],f=0;f<e;++f)a&1<<f&&c.push(f+1);for(var d=0;d<1<<c.length;++d){var p=c.slice();for(f=0;f<c.length;++f)d&1<<f&&(p[f]=-p[f]);r(p)}}o.push("return dst;};return gradient");var v=["diff","zero"],g=[h,l];for(a=1;a<=e;++a)v.push("grad"+a),g.push(u(a));v.push(o.join(""));var m=Function.apply(void 0,v).apply(void 0,g);return s[i]=m,m}(e)(t,i)};var o=e(96841),r=e(86239),s={},n={},a={body:"",args:[],thisVars:[],localVars:[]},h=r({args:["array","array","array"],pre:a,post:a,body:{args:[{name:"out",lvalue:!0,rvalue:!1,count:1},{name:"left",lvalue:!1,rvalue:!0,count:1},{name:"right",lvalue:!1,rvalue:!0,count:1}],body:"out=0.5*(left-right)",thisVars:[],localVars:[]},funcName:"cdiff"}),l=r({args:["array"],pre:a,post:a,body:{args:[{name:"out",lvalue:!0,rvalue:!1,count:1}],body:"out=0",thisVars:[],localVars:[]},funcName:"zero"});function u(t){if(t in s)return s[t];for(var i=[],e=0;e<t;++e)i.push("out",e,"s=0.5*(inp",e,"l-inp",e,"r);");var n=["array"],h=["junk"];for(e=0;e<t;++e){n.push("array"),h.push("out"+e+"s");var l=o(t);l[e]=-1,n.push({array:0,offset:l.slice()}),l[e]=1,n.push({array:0,offset:l.slice()}),h.push("inp"+e+"l","inp"+e+"r")}return s[t]=r({args:n,pre:a,post:a,body:{body:i.join(""),args:h.map((function(t){return{name:t,lvalue:0===t.indexOf("out"),rvalue:0===t.indexOf("inp"),count:"junk"!==t|0}})),thisVars:[],localVars:[]},funcName:"fdTemplate"+t})}},94096:t=>{"use strict";function i(t,i){var e=Math.floor(i),o=i-e,r=0<=e&&e<t.shape[0],s=0<=e+1&&e+1<t.shape[0];return(1-o)*(r?+t.get(e):0)+o*(s?+t.get(e+1):0)}function e(t,i,e){var o=Math.floor(i),r=i-o,s=0<=o&&o<t.shape[0],n=0<=o+1&&o+1<t.shape[0],a=Math.floor(e),h=e-a,l=0<=a&&a<t.shape[1],u=0<=a+1&&a+1<t.shape[1],c=s&&l?t.get(o,a):0,f=s&&u?t.get(o,a+1):0;return(1-h)*((1-r)*c+r*(n&&l?t.get(o+1,a):0))+h*((1-r)*f+r*(n&&u?t.get(o+1,a+1):0))}function o(t,i,e,o){var r=Math.floor(i),s=i-r,n=0<=r&&r<t.shape[0],a=0<=r+1&&r+1<t.shape[0],h=Math.floor(e),l=e-h,u=0<=h&&h<t.shape[1],c=0<=h+1&&h+1<t.shape[1],f=Math.floor(o),d=o-f,p=0<=f&&f<t.shape[2],v=0<=f+1&&f+1<t.shape[2],g=n&&u&&p?t.get(r,h,f):0,m=n&&c&&p?t.get(r,h+1,f):0,y=a&&u&&p?t.get(r+1,h,f):0,_=a&&c&&p?t.get(r+1,h+1,f):0,b=n&&u&&v?t.get(r,h,f+1):0,x=n&&c&&v?t.get(r,h+1,f+1):0;return(1-d)*((1-l)*((1-s)*g+s*y)+l*((1-s)*m+s*_))+d*((1-l)*((1-s)*b+s*(a&&u&&v?t.get(r+1,h,f+1):0))+l*((1-s)*x+s*(a&&c&&v?t.get(r+1,h+1,f+1):0)))}function r(t){var i,e,o=0|t.shape.length,r=new Array(o),s=new Array(o),n=new Array(o),a=new Array(o);for(i=0;i<o;++i)e=+arguments[i+1],r[i]=Math.floor(e),s[i]=e-r[i],n[i]=0<=r[i]&&r[i]<t.shape[i],a[i]=0<=r[i]+1&&r[i]+1<t.shape[i];var h,l,u,c=0;t:for(i=0;i<1<<o;++i){for(l=1,u=t.offset,h=0;h<o;++h)if(i&1<<h){if(!a[h])continue t;l*=s[h],u+=t.stride[h]*(r[h]+1)}else{if(!n[h])continue t;l*=1-s[h],u+=t.stride[h]*r[h]}c+=l*t.data[u]}return c}t.exports=function(t,s,n,a){switch(t.shape.length){case 0:return 0;case 1:return i(t,s);case 2:return e(t,s,n);case 3:return o(t,s,n,a);default:return r.apply(void 0,arguments)}},t.exports.d1=i,t.exports.d2=e,t.exports.d3=o},21943:(t,i,e)=>{"use strict";var o=e(62861),r=e(11895);t.exports=function(t,i){for(var e=[],s=t,n=1;Array.isArray(s);)e.push(s.length),n*=s.length,s=s[0];return 0===e.length?o():(i||(i=o(new Float64Array(n),e)),r(i,t),i)}},11895:(t,i,e)=>{t.exports=e(86239)({args:["array","scalar","index"],pre:{body:"{}",args:[],thisVars:[],localVars:[]},body:{body:"{\nvar _inline_1_v=_inline_1_arg1_,_inline_1_i\nfor(_inline_1_i=0;_inline_1_i<_inline_1_arg2_.length-1;++_inline_1_i) {\n_inline_1_v=_inline_1_v[_inline_1_arg2_[_inline_1_i]]\n}\n_inline_1_arg0_=_inline_1_v[_inline_1_arg2_[_inline_1_arg2_.length-1]]\n}",args:[{name:"_inline_1_arg0_",lvalue:!0,rvalue:!1,count:1},{name:"_inline_1_arg1_",lvalue:!1,rvalue:!0,count:1},{name:"_inline_1_arg2_",lvalue:!1,rvalue:!0,count:4}],thisVars:[],localVars:["_inline_1_i","_inline_1_v"]},post:{body:"{}",args:[],thisVars:[],localVars:[]},funcName:"convert",blockSize:64})},63170:(t,i,e)=>{"use strict";t.exports=e(48412)},27209:(t,i,e)=>{"use strict";var o=e(90336);t.exports=function(t,i){i.surfacecolor?o(t,i,{vals:i.surfacecolor,containerStr:"",cLetter:"c"}):o(t,i,{vals:i.z,containerStr:"",cLetter:"c"})}},58758:(t,i,e)=>{"use strict";var o=e(4933),r=e(62861),s=e(94096).d2,n=e(37353),a=e(68938),h=e(34141).isArrayOrTypedArray,l=e(72106).parseColorScale,u=e(59993),c=e(59430).extractOpts;function f(t,i,e){this.scene=t,this.uid=e,this.surface=i,this.data=null,this.showContour=[!1,!1,!1],this.contourStart=[null,null,null],this.contourEnd=[null,null,null],this.contourSize=[0,0,0],this.minValues=[1/0,1/0,1/0],this.maxValues=[-1/0,-1/0,-1/0],this.dataScaleX=1,this.dataScaleY=1,this.refineData=!0,this.objectOffset=[0,0,0]}var d=f.prototype;d.getXat=function(t,i,e,o){var r=h(this.data.x)?h(this.data.x[0])?this.data.x[i][t]:this.data.x[t]:t;return void 0===e?r:o.d2l(r,0,e)},d.getYat=function(t,i,e,o){var r=h(this.data.y)?h(this.data.y[0])?this.data.y[i][t]:this.data.y[i]:i;return void 0===e?r:o.d2l(r,0,e)},d.getZat=function(t,i,e,o){var r=this.data.z[i][t];return null===r&&this.data.connectgaps&&this.data._interpolatedZ&&(r=this.data._interpolatedZ[i][t]),void 0===e?r:o.d2l(r,0,e)},d.handlePick=function(t){if(t.object===this.surface){var i=(t.data.index[0]-1)/this.dataScaleX-1,e=(t.data.index[1]-1)/this.dataScaleY-1,o=Math.max(Math.min(Math.round(i),this.data.z[0].length-1),0),r=Math.max(Math.min(Math.round(e),this.data._ylength-1),0);t.index=[o,r],t.traceCoordinate=[this.getXat(o,r),this.getYat(o,r),this.getZat(o,r)],t.dataCoordinate=[this.getXat(o,r,this.data.xcalendar,this.scene.fullSceneLayout.xaxis),this.getYat(o,r,this.data.ycalendar,this.scene.fullSceneLayout.yaxis),this.getZat(o,r,this.data.zcalendar,this.scene.fullSceneLayout.zaxis)];for(var s=0;s<3;s++){null!=t.dataCoordinate[s]&&(t.dataCoordinate[s]*=this.scene.dataScale[s])}var n=this.data.hovertext||this.data.text;return Array.isArray(n)&&n[r]&&void 0!==n[r][o]?t.textLabel=n[r][o]:t.textLabel=n||"",t.data.dataCoordinate=t.dataCoordinate.slice(),this.surface.highlight(t.data),this.scene.glplot.spikes.position=t.dataCoordinate,!0}};var p=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997,1009,1013,1019,1021,1031,1033,1039,1049,1051,1061,1063,1069,1087,1091,1093,1097,1103,1109,1117,1123,1129,1151,1153,1163,1171,1181,1187,1193,1201,1213,1217,1223,1229,1231,1237,1249,1259,1277,1279,1283,1289,1291,1297,1301,1303,1307,1319,1321,1327,1361,1367,1373,1381,1399,1409,1423,1427,1429,1433,1439,1447,1451,1453,1459,1471,1481,1483,1487,1489,1493,1499,1511,1523,1531,1543,1549,1553,1559,1567,1571,1579,1583,1597,1601,1607,1609,1613,1619,1621,1627,1637,1657,1663,1667,1669,1693,1697,1699,1709,1721,1723,1733,1741,1747,1753,1759,1777,1783,1787,1789,1801,1811,1823,1831,1847,1861,1867,1871,1873,1877,1879,1889,1901,1907,1913,1931,1933,1949,1951,1973,1979,1987,1993,1997,1999,2003,2011,2017,2027,2029,2039,2053,2063,2069,2081,2083,2087,2089,2099,2111,2113,2129,2131,2137,2141,2143,2153,2161,2179,2203,2207,2213,2221,2237,2239,2243,2251,2267,2269,2273,2281,2287,2293,2297,2309,2311,2333,2339,2341,2347,2351,2357,2371,2377,2381,2383,2389,2393,2399,2411,2417,2423,2437,2441,2447,2459,2467,2473,2477,2503,2521,2531,2539,2543,2549,2551,2557,2579,2591,2593,2609,2617,2621,2633,2647,2657,2659,2663,2671,2677,2683,2687,2689,2693,2699,2707,2711,2713,2719,2729,2731,2741,2749,2753,2767,2777,2789,2791,2797,2801,2803,2819,2833,2837,2843,2851,2857,2861,2879,2887,2897,2903,2909,2917,2927,2939,2953,2957,2963,2969,2971,2999];function v(t,i){if(t<i)return 0;for(var e=0;0===Math.floor(t%i);)t/=i,e++;return e}function g(t){for(var i=[],e=0;e<p.length;e++){var o=p[e];i.push(v(t,o))}return i}function m(t){for(var i=g(t),e=t,o=0;o<p.length;o++)if(i[o]>0){e=p[o];break}return e}function y(t,i){if(!(t<1||i<1)){for(var e=g(t),o=g(i),r=1,s=0;s<p.length;s++)r*=Math.pow(p[s],Math.max(e[s],o[s]));return r}}d.calcXnums=function(t){var i,e=[];for(i=1;i<t;i++){var o=this.getXat(i-1,0),r=this.getXat(i,0);e[i-1]=r!==o&&null!=o&&null!=r?Math.abs(r-o):0}var s=0;for(i=1;i<t;i++)s+=e[i-1];for(i=1;i<t;i++)0===e[i-1]?e[i-1]=1:e[i-1]=Math.round(s/e[i-1]);return e},d.calcYnums=function(t){var i,e=[];for(i=1;i<t;i++){var o=this.getYat(0,i-1),r=this.getYat(0,i);e[i-1]=r!==o&&null!=o&&null!=r?Math.abs(r-o):0}var s=0;for(i=1;i<t;i++)s+=e[i-1];for(i=1;i<t;i++)0===e[i-1]?e[i-1]=1:e[i-1]=Math.round(s/e[i-1]);return e};var _=[1,2,4,6,12,24,36,48,60,120,180,240,360,720,840,1260],b=_[9],x=_[13];function w(t,i,e){var o=e[8]+e[2]*i[0]+e[5]*i[1];return t[0]=(e[6]+e[0]*i[0]+e[3]*i[1])/o,t[1]=(e[7]+e[1]*i[0]+e[4]*i[1])/o,t}function C(t,i,e){return function(t,i,e,o){for(var r=[0,0],n=t.shape[0],a=t.shape[1],h=0;h<n;h++)for(var l=0;l<a;l++)e(r,[h,l],o),t.set(h,l,s(i,r[0],r[1]))}(t,i,w,e),t}function j(t,i){for(var e=!1,o=0;o<t.length;o++)if(i===t[o]){e=!0;break}!1===e&&t.push(i)}d.estimateScale=function(t,i){for(var e=1+function(t){if(0!==t.length){for(var i=1,e=0;e<t.length;e++)i=y(i,t[e]);return i}}(0===i?this.calcXnums(t):this.calcYnums(t));e<b;)e*=2;for(;e>x;)e--,e/=m(e),++e<b&&(e=x);var o=Math.round(e/t);return o>1?o:1},d.refineCoords=function(t){for(var i=this.dataScaleX,e=this.dataScaleY,o=t[0].shape[0],s=t[0].shape[1],n=0|Math.floor(t[0].shape[0]*i+1),a=0|Math.floor(t[0].shape[1]*e+1),h=1+o+1,l=1+s+1,u=r(new Float32Array(h*l),[h,l]),c=[1/i,0,0,0,1/e,0,0,0,1],f=0;f<t.length;++f){this.surface.padField(u,t[f]);var d=r(new Float32Array(n*a),[n,a]);C(d,u,c),t[f]=d}},d.setContourLevels=function(){var t,i,e,o=[[],[],[]],r=[!1,!1,!1],s=!1;for(t=0;t<3;++t)if(this.showContour[t]&&(s=!0,this.contourSize[t]>0&&null!==this.contourStart[t]&&null!==this.contourEnd[t]&&this.contourEnd[t]>this.contourStart[t]))for(r[t]=!0,i=this.contourStart[t];i<this.contourEnd[t];i+=this.contourSize[t])e=i*this.scene.dataScale[t],j(o[t],e);if(s){var n=[[],[],[]];for(t=0;t<3;++t)this.showContour[t]&&(n[t]=r[t]?o[t]:this.scene.contourLevels[t]);this.surface.update({levels:n})}},d.update=function(t){var i,e,o,s,h=this.scene,f=h.fullSceneLayout,d=this.surface,p=t.opacity,v=l(t,p),g=h.dataScale,m=t.z[0].length,y=t._ylength,_=h.contourLevels;this.data=t;var b=[];for(i=0;i<3;i++)for(b[i]=[],e=0;e<m;e++)b[i][e]=[];for(e=0;e<m;e++)for(o=0;o<y;o++)b[0][e][o]=this.getXat(e,o,t.xcalendar,f.xaxis),b[1][e][o]=this.getYat(e,o,t.ycalendar,f.yaxis),b[2][e][o]=this.getZat(e,o,t.zcalendar,f.zaxis);if(t.connectgaps)for(t._emptypoints=a(b[2]),n(b[2],t._emptypoints),t._interpolatedZ=[],e=0;e<m;e++)for(t._interpolatedZ[e]=[],o=0;o<y;o++)t._interpolatedZ[e][o]=b[2][e][o];for(i=0;i<3;i++)for(e=0;e<m;e++)for(o=0;o<y;o++)null==(s=b[i][e][o])?b[i][e][o]=NaN:s=b[i][e][o]*=g[i];for(i=0;i<3;i++)for(e=0;e<m;e++)for(o=0;o<y;o++)null!=(s=b[i][e][o])&&(this.minValues[i]>s&&(this.minValues[i]=s),this.maxValues[i]<s&&(this.maxValues[i]=s));for(i=0;i<3;i++)this.objectOffset[i]=.5*(this.minValues[i]+this.maxValues[i]);for(i=0;i<3;i++)for(e=0;e<m;e++)for(o=0;o<y;o++)null!=(s=b[i][e][o])&&(b[i][e][o]-=this.objectOffset[i]);var w=[r(new Float32Array(m*y),[m,y]),r(new Float32Array(m*y),[m,y]),r(new Float32Array(m*y),[m,y])];for(i=0;i<3;i++)for(e=0;e<m;e++)for(o=0;o<y;o++)w[i].set(e,o,b[i][e][o]);b=[];var C={colormap:v,levels:[[],[],[]],showContour:[!0,!0,!0],showSurface:!t.hidesurface,contourProject:[[!1,!1,!1],[!1,!1,!1],[!1,!1,!1]],contourWidth:[1,1,1],contourColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],contourTint:[1,1,1],dynamicColor:[[1,1,1,1],[1,1,1,1],[1,1,1,1]],dynamicWidth:[1,1,1],dynamicTint:[1,1,1],opacityscale:t.opacityscale,opacity:t.opacity},j=c(t);if(C.intensityBounds=[j.min,j.max],t.surfacecolor){var S=r(new Float32Array(m*y),[m,y]);for(e=0;e<m;e++)for(o=0;o<y;o++)S.set(e,o,t.surfacecolor[o][e]);w.push(S)}else C.intensityBounds[0]*=g[2],C.intensityBounds[1]*=g[2];(x<w[0].shape[0]||x<w[0].shape[1])&&(this.refineData=!1),!0===this.refineData&&(this.dataScaleX=this.estimateScale(w[0].shape[0],0),this.dataScaleY=this.estimateScale(w[0].shape[1],1),1===this.dataScaleX&&1===this.dataScaleY||this.refineCoords(w)),t.surfacecolor&&(C.intensity=w.pop());var L=[!0,!0,!0],M=["x","y","z"];for(i=0;i<3;++i){var B=t.contours[M[i]];L[i]=B.highlight,C.showContour[i]=B.show||B.highlight,C.showContour[i]&&(C.contourProject[i]=[B.project.x,B.project.y,B.project.z],B.show?(this.showContour[i]=!0,C.levels[i]=_[i],d.highlightColor[i]=C.contourColor[i]=u(B.color),B.usecolormap?d.highlightTint[i]=C.contourTint[i]=0:d.highlightTint[i]=C.contourTint[i]=1,C.contourWidth[i]=B.width,this.contourStart[i]=B.start,this.contourEnd[i]=B.end,this.contourSize[i]=B.size):(this.showContour[i]=!1,this.contourStart[i]=null,this.contourEnd[i]=null,this.contourSize[i]=0),B.highlight&&(C.dynamicColor[i]=u(B.highlightcolor),C.dynamicWidth[i]=B.highlightwidth))}(function(t){var i=t[0].rgb,e=t[t.length-1].rgb;return i[0]===e[0]&&i[1]===e[1]&&i[2]===e[2]&&i[3]===e[3]})(v)&&(C.vertexColor=!0),C.objectOffset=this.objectOffset,C.coords=w,d.update(C),d.visible=t.visible,d.enableDynamic=L,d.enableHighlight=L,d.snapToData=!0,"lighting"in t&&(d.ambientLight=t.lighting.ambient,d.diffuseLight=t.lighting.diffuse,d.specularLight=t.lighting.specular,d.roughness=t.lighting.roughness,d.fresnel=t.lighting.fresnel),"lightposition"in t&&(d.lightPosition=[t.lightposition.x,t.lightposition.y,t.lightposition.z]),p&&p<1&&(d.supportsTransparency=!0)},d.dispose=function(){this.scene.glplot.remove(this.surface),this.surface.dispose()},t.exports=function(t,i){var e=t.glplot.gl,r=o({gl:e}),s=new f(t,r,i.uid);return r._trace=s,s.update(i),t.glplot.add(r),s}},9050:(t,i,e)=>{"use strict";var o=e(97997),r=e(34141),s=e(62252),n=e(71698);function a(t,i,e,o){var r=o("opacityscale");"max"===r?i.opacityscale=[[0,.1],[1,1]]:"min"===r?i.opacityscale=[[0,1],[1,.1]]:"extremes"===r?i.opacityscale=function(t,i){for(var e=[],o=0;o<32;o++){var r=o/31,s=.1+.9*(1-Math.pow(Math.sin(1*r*Math.PI),2));e.push([r,Math.max(0,Math.min(1,s))])}return e}():function(t){var i=0;if(!Array.isArray(t)||t.length<2)return!1;if(!t[0]||!t[t.length-1])return!1;if(0!=+t[0][0]||1!=+t[t.length-1][0])return!1;for(var e=0;e<t.length;e++){var o=t[e];if(2!==o.length||+o[0]<i)return!1;i=+o[0]}return!0}(r)||(i.opacityscale=void 0)}function h(t,i,e){i in t&&!(e in t)&&(t[e]=t[i])}t.exports={supplyDefaults:function(t,i,e,l){var u,c;function f(e,o){return r.coerce(t,i,n,e,o)}var d=f("x"),p=f("y"),v=f("z");if(!v||!v.length||d&&d.length<1||p&&p.length<1)i.visible=!1;else{i._xlength=Array.isArray(d)&&r.isArrayOrTypedArray(d[0])?v.length:v[0].length,i._ylength=v.length,o.getComponentMethod("calendars","handleTraceDefaults")(t,i,["x","y","z"],l),f("text"),f("hovertext"),f("hovertemplate"),["lighting.ambient","lighting.diffuse","lighting.specular","lighting.roughness","lighting.fresnel","lightposition.x","lightposition.y","lightposition.z","hidesurface","connectgaps","opacity"].forEach((function(t){f(t)}));var g=f("surfacecolor"),m=["x","y","z"];for(u=0;u<3;++u){var y="contours."+m[u],_=f(y+".show"),b=f(y+".highlight");if(_||b)for(c=0;c<3;++c)f(y+".project."+m[c]);_&&(f(y+".color"),f(y+".width"),f(y+".usecolormap")),b&&(f(y+".highlightcolor"),f(y+".highlightwidth")),f(y+".start"),f(y+".end"),f(y+".size")}g||(h(t,"zmin","cmin"),h(t,"zmax","cmax"),h(t,"zauto","cauto")),s(t,i,l,f,{prefix:"",cLetter:"c"}),a(0,i,0,f),i._length=null}},opacityscaleDefaults:a}},48412:(t,i,e)=>{"use strict";t.exports={attributes:e(71698),supplyDefaults:e(9050).supplyDefaults,colorbar:{min:"cmin",max:"cmax"},calc:e(27209),plot:e(58758),moduleType:"trace",name:"surface",basePlotModule:e(20883),categories:["gl3d","2dMap","showLegend"],meta:{description:["The data the describes the coordinates of the surface is set in `z`.","Data in `z` should be a {2D array}.","Coordinates in `x` and `y` can either be 1D {arrays}","or {2D arrays} (e.g. to graph parametric surfaces).","If not provided in `x` and `y`, the x and y coordinates are assumed","to be linear starting at 0 with a unit step.","The color scale corresponds to the `z` values by default.","For custom color scales, use `surfacecolor` which should be a {2D array},","where its bounds can be controlled using `cmin` and `cmax`."].join(" ")}}}}]);
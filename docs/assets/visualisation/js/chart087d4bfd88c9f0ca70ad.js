(self.webpackChunkdi_website=self.webpackChunkdi_website||[]).push([[3980],{94770:(t,e,n)=>{"use strict";n.r(e),n.d(e,{sankeyCircular:()=>T,sankeyCenter:()=>h,sankeyLeft:()=>u,sankeyRight:()=>s,sankeyJustify:()=>f});var r=n(61079),a=n(31654),i=n(1861),o=n(23889),l=n.n(o);function c(t){return t.target.depth}function u(t){return t.depth}function s(t,e){return e-1-t.height}function f(t,e){return t.sourceLinks.length?t.depth:e-1}function h(t){return t.targetLinks.length?t.depth:t.sourceLinks.length?(0,r.VV)(t.sourceLinks,c)-1:0}function d(t){return function(){return t}}var y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};function g(t,e){return v(t.source,e.source)||t.index-e.index}function p(t,e){return v(t.target,e.target)||t.index-e.index}function v(t,e){return t.partOfCycle===e.partOfCycle?t.y0-e.y0:"top"===t.circularLinkType||"bottom"===e.circularLinkType?-1:1}function x(t){return t.value}function k(t){return(t.y0+t.y1)/2}function m(t){return k(t.source)}function L(t){return k(t.target)}function _(t){return t.index}function b(t){return t.nodes}function w(t){return t.links}function A(t,e){var n=t.get(e);if(!n)throw new Error("missing: "+e);return n}function E(t,e){return e(t)}var P=25,D=10;function T(){var t,e,n=0,i=0,o=1,l=1,c=24,u=_,s=f,h=b,E=w,T=32,S=2,F=null;function M(){var t={nodes:h.apply(null,arguments),links:E.apply(null,arguments)};O(t),I(t,0,F),z(t),Y(t),R(t,u),j(t,T,u),X(t);for(var e=4,n=0;n<e;n++)U(t,l,u),J(t,0,u),G(t,i,l,u),U(t,l,u),J(t,0,u);return $(t,i,l),C(t,S,l,u),t}function O(t){t.nodes.forEach((function(t,e){t.index=e,t.sourceLinks=[],t.targetLinks=[]}));var e=(0,a.UI)(t.nodes,u);return t.links.forEach((function(t,n){t.index=n;var r=t.source,a=t.target;"object"!==(void 0===r?"undefined":y(r))&&(r=t.source=A(e,r)),"object"!==(void 0===a?"undefined":y(a))&&(a=t.target=A(e,a)),r.sourceLinks.push(t),a.targetLinks.push(t)})),t}function z(t){t.nodes.forEach((function(t){t.partOfCycle=!1,t.value=Math.max((0,r.Sm)(t.sourceLinks,x),(0,r.Sm)(t.targetLinks,x)),t.sourceLinks.forEach((function(e){e.circular&&(t.partOfCycle=!0,t.circularLinkType=e.circularLinkType)})),t.targetLinks.forEach((function(e){e.circular&&(t.partOfCycle=!0,t.circularLinkType=e.circularLinkType)}))}))}function Y(t){var e,n,r;for(e=t.nodes,n=[],r=0;e.length;++r,e=n,n=[])e.forEach((function(t){t.depth=r,t.sourceLinks.forEach((function(t){n.indexOf(t.target)<0&&!t.circular&&n.push(t.target)}))}));for(e=t.nodes,n=[],r=0;e.length;++r,e=n,n=[])e.forEach((function(t){t.height=r,t.targetLinks.forEach((function(t){n.indexOf(t.source)<0&&!t.circular&&n.push(t.source)}))}));t.nodes.forEach((function(t){t.column=Math.floor(s.call(null,t,r))}))}function j(u,s,f){var h=(0,a.b1)().key((function(t){return t.column})).sortKeys(r.j2).entries(u.nodes).map((function(t){return t.values}));!function(a){if(e){var s=1/0;h.forEach((function(t){var n=l*e/(t.length+1);s=n<s?n:s})),t=s}var f=(0,r.VV)(h,(function(e){return(l-i-(e.length-1)*t)/(0,r.Sm)(e,x)}));f*=.3,u.links.forEach((function(t){t.width=t.value*f}));var d=function(t){var e=0,n=0,a=0,i=0,o=(0,r.Fp)(t.nodes,(function(t){return t.column}));return t.links.forEach((function(t){t.circular&&("top"==t.circularLinkType?e+=t.width:n+=t.width,0==t.target.column&&(i+=t.width),t.source.column==o&&(a+=t.width))})),{top:e=e>0?e+P+D:e,bottom:n=n>0?n+P+D:n,left:i=i>0?i+P+D:i,right:a=a>0?a+P+D:a}}(u),y=function(t,e){var a=(0,r.Fp)(t.nodes,(function(t){return t.column})),u=o-n,s=l-i,f=u/(u+e.right+e.left),h=s/(s+e.top+e.bottom);return n=n*f+e.left,o=0==e.right?o:o*f,i=i*h+e.top,l*=h,t.nodes.forEach((function(t){t.x0=n+t.column*((o-n-c)/a),t.x1=t.x0+c})),h}(u,d);f*=y,u.links.forEach((function(t){t.width=t.value*f})),h.forEach((function(t){var e=t.length;t.forEach((function(t,n){t.depth==h.length-1&&1==e||0==t.depth&&1==e?(t.y0=l/2-t.value*f,t.y1=t.y0+t.value*f):t.partOfCycle?0==N(t,a)?(t.y0=l/2+n,t.y1=t.y0+t.value*f):"top"==t.circularLinkType?(t.y0=i+n,t.y1=t.y0+t.value*f):(t.y0=l-t.value*f-n,t.y1=t.y0+t.value*f):0==d.top||0==d.bottom?(t.y0=(l-i)/e*n,t.y1=t.y0+t.value*f):(t.y0=(l-i)/2-e/2+n,t.y1=t.y0+t.value*f)}))}))}(f),p();for(var d=1,y=s;y>0;--y)g(d*=.99,f),p();function g(t,e){var n=h.length;h.forEach((function(a){var i=a.length,o=a[0].depth;a.forEach((function(a){var c;if(a.sourceLinks.length||a.targetLinks.length)if(a.partOfCycle&&N(a,e)>0);else if(0==o&&1==i)c=a.y1-a.y0,a.y0=l/2-c/2,a.y1=l/2+c/2;else if(o==n-1&&1==i)c=a.y1-a.y0,a.y0=l/2-c/2,a.y1=l/2+c/2;else{var u=(0,r.J6)(a.sourceLinks,L),s=(0,r.J6)(a.targetLinks,m),f=((u&&s?(u+s)/2:u||s)-k(a))*t;a.y0+=f,a.y1+=f}}))}))}function p(){h.forEach((function(e){var n,r,a,o=i,c=e.length;for(e.sort(v),a=0;a<c;++a)(r=o-(n=e[a]).y0)>0&&(n.y0+=r,n.y1+=r),o=n.y1+t;if((r=o-t-l)>0)for(o=n.y0-=r,n.y1-=r,a=c-2;a>=0;--a)(r=(n=e[a]).y1+t-o)>0&&(n.y0-=r,n.y1-=r),o=n.y0}))}}function X(t){t.nodes.forEach((function(t){t.sourceLinks.sort(p),t.targetLinks.sort(g)})),t.nodes.forEach((function(t){var e=t.y0,n=e,r=t.y1,a=r;t.sourceLinks.forEach((function(t){t.circular?(t.y0=r-t.width/2,r-=t.width):(t.y0=e+t.width/2,e+=t.width)})),t.targetLinks.forEach((function(t){t.circular?(t.y1=a-t.width/2,a-=t.width):(t.y1=n+t.width/2,n+=t.width)}))}))}return M.nodeId=function(t){return arguments.length?(u="function"==typeof t?t:d(t),M):u},M.nodeAlign=function(t){return arguments.length?(s="function"==typeof t?t:d(t),M):s},M.nodeWidth=function(t){return arguments.length?(c=+t,M):c},M.nodePadding=function(e){return arguments.length?(t=+e,M):t},M.nodes=function(t){return arguments.length?(h="function"==typeof t?t:d(t),M):h},M.links=function(t){return arguments.length?(E="function"==typeof t?t:d(t),M):E},M.size=function(t){return arguments.length?(n=i=0,o=+t[0],l=+t[1],M):[o-n,l-i]},M.extent=function(t){return arguments.length?(n=+t[0][0],o=+t[1][0],i=+t[0][1],l=+t[1][1],M):[[n,i],[o,l]]},M.iterations=function(t){return arguments.length?(T=+t,M):T},M.circularLinkGap=function(t){return arguments.length?(S=+t,M):S},M.nodePaddingRatio=function(t){return arguments.length?(e=+t,M):e},M.sortNodes=function(t){return arguments.length?(F=t,M):F},M.update=function(t){return R(t,u),X(t),t.links.forEach((function(t){t.circular&&(t.circularLinkType=t.y0+t.y1<l?"top":"bottom",t.source.circularLinkType=t.circularLinkType,t.target.circularLinkType=t.circularLinkType)})),U(t,l,u,!1),J(t,0,u),C(t,S,l,u),t},M}function I(t,e,n){var r=0;if(null===n){for(var a=[],i=0;i<t.links.length;i++){var o=t.links[i],c=o.source.index,u=o.target.index;a[c]||(a[c]=[]),a[u]||(a[u]=[]),-1===a[c].indexOf(u)&&a[c].push(u)}var s=l()(a);s.sort((function(t,e){return t.length-e.length}));var f={};for(i=0;i<s.length;i++){var h=s[i].slice(-2);f[h[0]]||(f[h[0]]={}),f[h[0]][h[1]]=!0}t.links.forEach((function(t){var e=t.target.index,n=t.source.index;e===n||f[n]&&f[n][e]?(t.circular=!0,t.circularLinkID=r,r+=1):t.circular=!1}))}else t.links.forEach((function(t){t.source[n]<t.target[n]?t.circular=!1:(t.circular=!0,t.circularLinkID=r,r+=1)}))}function R(t,e){var n=0,r=0;t.links.forEach((function(a){a.circular&&(a.source.circularLinkType||a.target.circularLinkType?a.circularLinkType=a.source.circularLinkType?a.source.circularLinkType:a.target.circularLinkType:a.circularLinkType=n<r?"top":"bottom","top"==a.circularLinkType?n+=1:r+=1,t.nodes.forEach((function(t){E(t,e)!=E(a.source,e)&&E(t,e)!=E(a.target,e)||(t.circularLinkType=a.circularLinkType)})))})),t.links.forEach((function(t){t.circular&&(t.source.circularLinkType==t.target.circularLinkType&&(t.circularLinkType=t.source.circularLinkType),Q(t,e)&&(t.circularLinkType=t.source.circularLinkType))}))}function S(t){var e=Math.abs(t.y1-t.y0),n=Math.abs(t.target.x0-t.source.x1);return Math.atan(n/e)}function N(t,e){var n=0;t.sourceLinks.forEach((function(t){n=t.circular&&!Q(t,e)?n+1:n}));var r=0;return t.targetLinks.forEach((function(t){r=t.circular&&!Q(t,e)?r+1:r})),n+r}function F(t){var e=t.source.sourceLinks,n=0;e.forEach((function(t){n=t.circular?n+1:n}));var r=t.target.targetLinks,a=0;return r.forEach((function(t){a=t.circular?a+1:a})),!(n>1||a>1)}function M(t,e,n){return t.sort(O),t.forEach((function(r,a){var i,o,l=0;if(Q(r,n)&&F(r))r.circularPathData.verticalBuffer=l+r.width/2;else{for(var c=0;c<a;c++)if(i=t[a],o=t[c],!(i.source.column<o.target.column||i.target.column>o.source.column)){var u=t[c].circularPathData.verticalBuffer+t[c].width/2+e;l=u>l?u:l}r.circularPathData.verticalBuffer=l+r.width/2}})),t}function C(t,e,n,a){var o=(0,r.VV)(t.links,(function(t){return t.source.y0}));t.links.forEach((function(t){t.circular&&(t.circularPathData={})})),M(t.links.filter((function(t){return"top"==t.circularLinkType})),e,a),M(t.links.filter((function(t){return"bottom"==t.circularLinkType})),e,a),t.links.forEach((function(r){if(r.circular){if(r.circularPathData.arcRadius=r.width+D,r.circularPathData.leftNodeBuffer=5,r.circularPathData.rightNodeBuffer=5,r.circularPathData.sourceWidth=r.source.x1-r.source.x0,r.circularPathData.sourceX=r.source.x0+r.circularPathData.sourceWidth,r.circularPathData.targetX=r.target.x0,r.circularPathData.sourceY=r.y0,r.circularPathData.targetY=r.y1,Q(r,a)&&F(r))r.circularPathData.leftSmallArcRadius=D+r.width/2,r.circularPathData.leftLargeArcRadius=D+r.width/2,r.circularPathData.rightSmallArcRadius=D+r.width/2,r.circularPathData.rightLargeArcRadius=D+r.width/2,"bottom"==r.circularLinkType?(r.circularPathData.verticalFullExtent=r.source.y1+P+r.circularPathData.verticalBuffer,r.circularPathData.verticalLeftInnerExtent=r.circularPathData.verticalFullExtent-r.circularPathData.leftLargeArcRadius,r.circularPathData.verticalRightInnerExtent=r.circularPathData.verticalFullExtent-r.circularPathData.rightLargeArcRadius):(r.circularPathData.verticalFullExtent=r.source.y0-P-r.circularPathData.verticalBuffer,r.circularPathData.verticalLeftInnerExtent=r.circularPathData.verticalFullExtent+r.circularPathData.leftLargeArcRadius,r.circularPathData.verticalRightInnerExtent=r.circularPathData.verticalFullExtent+r.circularPathData.rightLargeArcRadius);else{var l=r.source.column,c=r.circularLinkType,u=t.links.filter((function(t){return t.source.column==l&&t.circularLinkType==c}));"bottom"==r.circularLinkType?u.sort(Y):u.sort(z);var s=0;u.forEach((function(t,n){t.circularLinkID==r.circularLinkID&&(r.circularPathData.leftSmallArcRadius=D+r.width/2+s,r.circularPathData.leftLargeArcRadius=D+r.width/2+n*e+s),s+=t.width})),l=r.target.column,u=t.links.filter((function(t){return t.target.column==l&&t.circularLinkType==c})),"bottom"==r.circularLinkType?u.sort(X):u.sort(j),s=0,u.forEach((function(t,n){t.circularLinkID==r.circularLinkID&&(r.circularPathData.rightSmallArcRadius=D+r.width/2+s,r.circularPathData.rightLargeArcRadius=D+r.width/2+n*e+s),s+=t.width})),"bottom"==r.circularLinkType?(r.circularPathData.verticalFullExtent=Math.max(n,r.source.y1,r.target.y1)+P+r.circularPathData.verticalBuffer,r.circularPathData.verticalLeftInnerExtent=r.circularPathData.verticalFullExtent-r.circularPathData.leftLargeArcRadius,r.circularPathData.verticalRightInnerExtent=r.circularPathData.verticalFullExtent-r.circularPathData.rightLargeArcRadius):(r.circularPathData.verticalFullExtent=o-P-r.circularPathData.verticalBuffer,r.circularPathData.verticalLeftInnerExtent=r.circularPathData.verticalFullExtent+r.circularPathData.leftLargeArcRadius,r.circularPathData.verticalRightInnerExtent=r.circularPathData.verticalFullExtent+r.circularPathData.rightLargeArcRadius)}r.circularPathData.leftInnerExtent=r.circularPathData.sourceX+r.circularPathData.leftNodeBuffer,r.circularPathData.rightInnerExtent=r.circularPathData.targetX-r.circularPathData.rightNodeBuffer,r.circularPathData.leftFullExtent=r.circularPathData.sourceX+r.circularPathData.leftLargeArcRadius+r.circularPathData.leftNodeBuffer,r.circularPathData.rightFullExtent=r.circularPathData.targetX-r.circularPathData.rightLargeArcRadius-r.circularPathData.rightNodeBuffer}if(r.circular)r.path=function(t){return"top"==t.circularLinkType?"M"+t.circularPathData.sourceX+" "+t.circularPathData.sourceY+" L"+t.circularPathData.leftInnerExtent+" "+t.circularPathData.sourceY+" A"+t.circularPathData.leftLargeArcRadius+" "+t.circularPathData.leftSmallArcRadius+" 0 0 0 "+t.circularPathData.leftFullExtent+" "+(t.circularPathData.sourceY-t.circularPathData.leftSmallArcRadius)+" L"+t.circularPathData.leftFullExtent+" "+t.circularPathData.verticalLeftInnerExtent+" A"+t.circularPathData.leftLargeArcRadius+" "+t.circularPathData.leftLargeArcRadius+" 0 0 0 "+t.circularPathData.leftInnerExtent+" "+t.circularPathData.verticalFullExtent+" L"+t.circularPathData.rightInnerExtent+" "+t.circularPathData.verticalFullExtent+" A"+t.circularPathData.rightLargeArcRadius+" "+t.circularPathData.rightLargeArcRadius+" 0 0 0 "+t.circularPathData.rightFullExtent+" "+t.circularPathData.verticalRightInnerExtent+" L"+t.circularPathData.rightFullExtent+" "+(t.circularPathData.targetY-t.circularPathData.rightSmallArcRadius)+" A"+t.circularPathData.rightLargeArcRadius+" "+t.circularPathData.rightSmallArcRadius+" 0 0 0 "+t.circularPathData.rightInnerExtent+" "+t.circularPathData.targetY+" L"+t.circularPathData.targetX+" "+t.circularPathData.targetY:"M"+t.circularPathData.sourceX+" "+t.circularPathData.sourceY+" L"+t.circularPathData.leftInnerExtent+" "+t.circularPathData.sourceY+" A"+t.circularPathData.leftLargeArcRadius+" "+t.circularPathData.leftSmallArcRadius+" 0 0 1 "+t.circularPathData.leftFullExtent+" "+(t.circularPathData.sourceY+t.circularPathData.leftSmallArcRadius)+" L"+t.circularPathData.leftFullExtent+" "+t.circularPathData.verticalLeftInnerExtent+" A"+t.circularPathData.leftLargeArcRadius+" "+t.circularPathData.leftLargeArcRadius+" 0 0 1 "+t.circularPathData.leftInnerExtent+" "+t.circularPathData.verticalFullExtent+" L"+t.circularPathData.rightInnerExtent+" "+t.circularPathData.verticalFullExtent+" A"+t.circularPathData.rightLargeArcRadius+" "+t.circularPathData.rightLargeArcRadius+" 0 0 1 "+t.circularPathData.rightFullExtent+" "+t.circularPathData.verticalRightInnerExtent+" L"+t.circularPathData.rightFullExtent+" "+(t.circularPathData.targetY+t.circularPathData.rightSmallArcRadius)+" A"+t.circularPathData.rightLargeArcRadius+" "+t.circularPathData.rightSmallArcRadius+" 0 0 1 "+t.circularPathData.rightInnerExtent+" "+t.circularPathData.targetY+" L"+t.circularPathData.targetX+" "+t.circularPathData.targetY}(r);else{var f=(0,i.h5)().source((function(t){return[t.source.x0+(t.source.x1-t.source.x0),t.y0]})).target((function(t){return[t.target.x0,t.y1]}));r.path=f(r)}}))}function O(t,e){return B(t)==B(e)?"bottom"==t.circularLinkType?Y(t,e):z(t,e):B(e)-B(t)}function z(t,e){return t.y0-e.y0}function Y(t,e){return e.y0-t.y0}function j(t,e){return t.y1-e.y1}function X(t,e){return e.y1-t.y1}function B(t){return t.target.column-t.source.column}function q(t){return t.target.x0-t.source.x1}function H(t,e){var n=S(t),r=q(e)/Math.tan(n);return"up"==K(t)?t.y1+r:t.y1-r}function W(t,e){var n=S(t),r=q(e)/Math.tan(n);return"up"==K(t)?t.y1-r:t.y1+r}function G(t,e,n,r){t.links.forEach((function(a){if(!a.circular&&a.target.column-a.source.column>1){var i=a.source.column+1,o=a.target.column-1,l=1,c=o-i+1;for(l=1;i<=o;i++,l++)t.nodes.forEach((function(o){if(o.column==i){var u,s=l/(c+1),f=Math.pow(1-s,3),h=3*s*Math.pow(1-s,2),d=3*Math.pow(s,2)*(1-s),y=Math.pow(s,3),g=f*a.y0+h*a.y0+d*a.y1+y*a.y1,p=g-a.width/2,v=g+a.width/2;p>o.y0&&p<o.y1?(u=o.y1-p+10,u="bottom"==o.circularLinkType?u:-u,o=V(o,u,e,n),t.nodes.forEach((function(t){var a,i;E(t,r)!=E(o,r)&&t.column==o.column&&(i=t,(a=o).y0>i.y0&&a.y0<i.y1||a.y1>i.y0&&a.y1<i.y1||a.y0<i.y0&&a.y1>i.y1)&&V(t,u,e,n)}))):(v>o.y0&&v<o.y1||p<o.y0&&v>o.y1)&&(u=v-o.y0+10,o=V(o,u,e,n),t.nodes.forEach((function(t){E(t,r)!=E(o,r)&&t.column==o.column&&t.y0<o.y1&&t.y1>o.y1&&V(t,u,e,n)})))}}))}}))}function V(t,e,n,r){return t.y0+e>=n&&t.y1+e<=r&&(t.y0=t.y0+e,t.y1=t.y1+e,t.targetLinks.forEach((function(t){t.y1=t.y1+e})),t.sourceLinks.forEach((function(t){t.y0=t.y0+e}))),t}function U(t,e,n,r){t.nodes.forEach((function(a){r&&a.y+(a.y1-a.y0)>e&&(a.y=a.y-(a.y+(a.y1-a.y0)-e));var i=t.links.filter((function(t){return E(t.source,n)==E(a,n)})),o=i.length;o>1&&i.sort((function(t,e){if(!t.circular&&!e.circular){if(t.target.column==e.target.column)return t.y1-e.y1;if(!Z(t,e))return t.y1-e.y1;if(t.target.column>e.target.column){var n=W(e,t);return t.y1-n}if(e.target.column>t.target.column)return W(t,e)-e.y1}return t.circular&&!e.circular?"top"==t.circularLinkType?-1:1:e.circular&&!t.circular?"top"==e.circularLinkType?1:-1:t.circular&&e.circular?t.circularLinkType===e.circularLinkType&&"top"==t.circularLinkType?t.target.column===e.target.column?t.target.y1-e.target.y1:e.target.column-t.target.column:t.circularLinkType===e.circularLinkType&&"bottom"==t.circularLinkType?t.target.column===e.target.column?e.target.y1-t.target.y1:t.target.column-e.target.column:"top"==t.circularLinkType?-1:1:void 0}));var l=a.y0;i.forEach((function(t){t.y0=l+t.width/2,l+=t.width})),i.forEach((function(t,e){if("bottom"==t.circularLinkType){for(var n=e+1,r=0;n<o;n++)r+=i[n].width;t.y0=a.y1-r-t.width/2}}))}))}function J(t,e,n){t.nodes.forEach((function(e){var r=t.links.filter((function(t){return E(t.target,n)==E(e,n)})),a=r.length;a>1&&r.sort((function(t,e){if(!t.circular&&!e.circular){if(t.source.column==e.source.column)return t.y0-e.y0;if(!Z(t,e))return t.y0-e.y0;if(e.source.column<t.source.column){var n=H(e,t);return t.y0-n}if(t.source.column<e.source.column)return H(t,e)-e.y0}return t.circular&&!e.circular?"top"==t.circularLinkType?-1:1:e.circular&&!t.circular?"top"==e.circularLinkType?1:-1:t.circular&&e.circular?t.circularLinkType===e.circularLinkType&&"top"==t.circularLinkType?t.source.column===e.source.column?t.source.y1-e.source.y1:t.source.column-e.source.column:t.circularLinkType===e.circularLinkType&&"bottom"==t.circularLinkType?t.source.column===e.source.column?t.source.y1-e.source.y1:e.source.column-t.source.column:"top"==t.circularLinkType?-1:1:void 0}));var i=e.y0;r.forEach((function(t){t.y1=i+t.width/2,i+=t.width})),r.forEach((function(t,n){if("bottom"==t.circularLinkType){for(var i=n+1,o=0;i<a;i++)o+=r[i].width;t.y1=e.y1-o-t.width/2}}))}))}function Z(t,e){return K(t)==K(e)}function K(t){return t.y0-t.y1>0?"up":"down"}function Q(t,e){return E(t.source,e)==E(t.target,e)}function $(t,e,n){var a=t.nodes,i=t.links,o=!1,l=!1;if(i.forEach((function(t){"top"==t.circularLinkType?o=!0:"bottom"==t.circularLinkType&&(l=!0)})),0==o||0==l){var c=(0,r.VV)(a,(function(t){return t.y0})),u=(n-e)/((0,r.Fp)(a,(function(t){return t.y1}))-c);a.forEach((function(t){var e=(t.y1-t.y0)*u;t.y0=(t.y0-c)*u,t.y1=t.y0+e})),i.forEach((function(t){t.y0=(t.y0-c)*u,t.y1=(t.y1-c)*u,t.width=t.width*u}))}}},65589:(t,e,n)=>{"use strict";n.r(e),n.d(e,{sankey:()=>_,sankeyCenter:()=>u,sankeyJustify:()=>c,sankeyLeft:()=>o,sankeyLinkHorizontal:()=>E,sankeyRight:()=>l});var r=n(61079),a=n(31654);function i(t){return t.target.depth}function o(t){return t.depth}function l(t,e){return e-1-t.height}function c(t,e){return t.sourceLinks.length?t.depth:e-1}function u(t){return t.targetLinks.length?t.depth:t.sourceLinks.length?(0,r.VV)(t.sourceLinks,i)-1:0}function s(t){return function(){return t}}function f(t,e){return d(t.source,e.source)||t.index-e.index}function h(t,e){return d(t.target,e.target)||t.index-e.index}function d(t,e){return t.y0-e.y0}function y(t){return t.value}function g(t){return(t.y0+t.y1)/2}function p(t){return g(t.source)*t.value}function v(t){return g(t.target)*t.value}function x(t){return t.index}function k(t){return t.nodes}function m(t){return t.links}function L(t,e){var n=t.get(e);if(!n)throw new Error("missing: "+e);return n}function _(){var t=0,e=0,n=1,i=1,o=24,l=8,u=x,_=c,b=k,w=m,A=32;function E(){var t={nodes:b.apply(null,arguments),links:w.apply(null,arguments)};return P(t),D(t),T(t),I(t),R(t),t}function P(t){t.nodes.forEach((function(t,e){t.index=e,t.sourceLinks=[],t.targetLinks=[]}));var e=(0,a.UI)(t.nodes,u);t.links.forEach((function(t,n){t.index=n;var r=t.source,a=t.target;"object"!=typeof r&&(r=t.source=L(e,r)),"object"!=typeof a&&(a=t.target=L(e,a)),r.sourceLinks.push(t),a.targetLinks.push(t)}))}function D(t){t.nodes.forEach((function(t){t.value=Math.max((0,r.Sm)(t.sourceLinks,y),(0,r.Sm)(t.targetLinks,y))}))}function T(e){var r,a,i;for(r=e.nodes,a=[],i=0;r.length;++i,r=a,a=[])r.forEach((function(t){t.depth=i,t.sourceLinks.forEach((function(t){a.indexOf(t.target)<0&&a.push(t.target)}))}));for(r=e.nodes,a=[],i=0;r.length;++i,r=a,a=[])r.forEach((function(t){t.height=i,t.targetLinks.forEach((function(t){a.indexOf(t.source)<0&&a.push(t.source)}))}));var l=(n-t-o)/(i-1);e.nodes.forEach((function(e){e.x1=(e.x0=t+Math.max(0,Math.min(i-1,Math.floor(_.call(null,e,i))))*l)+o}))}function I(t){var n=(0,a.b1)().key((function(t){return t.x0})).sortKeys(r.j2).entries(t.nodes).map((function(t){return t.values}));!function(){var a=(0,r.Fp)(n,(function(t){return t.length})),o=.6666666666666666*(i-e)/(a-1);l>o&&(l=o);var c=(0,r.VV)(n,(function(t){return(i-e-(t.length-1)*l)/(0,r.Sm)(t,y)}));n.forEach((function(t){t.forEach((function(t,e){t.y1=(t.y0=e)+t.value*c}))})),t.links.forEach((function(t){t.width=t.value*c}))}(),f();for(var o=1,c=A;c>0;--c)s(o*=.99),f(),u(o),f();function u(t){n.forEach((function(e){e.forEach((function(e){if(e.targetLinks.length){var n=((0,r.Sm)(e.targetLinks,p)/(0,r.Sm)(e.targetLinks,y)-g(e))*t;e.y0+=n,e.y1+=n}}))}))}function s(t){n.slice().reverse().forEach((function(e){e.forEach((function(e){if(e.sourceLinks.length){var n=((0,r.Sm)(e.sourceLinks,v)/(0,r.Sm)(e.sourceLinks,y)-g(e))*t;e.y0+=n,e.y1+=n}}))}))}function f(){n.forEach((function(t){var n,r,a,o=e,c=t.length;for(t.sort(d),a=0;a<c;++a)(r=o-(n=t[a]).y0)>0&&(n.y0+=r,n.y1+=r),o=n.y1+l;if((r=o-l-i)>0)for(o=n.y0-=r,n.y1-=r,a=c-2;a>=0;--a)(r=(n=t[a]).y1+l-o)>0&&(n.y0-=r,n.y1-=r),o=n.y0}))}}function R(t){t.nodes.forEach((function(t){t.sourceLinks.sort(h),t.targetLinks.sort(f)})),t.nodes.forEach((function(t){var e=t.y0,n=e;t.sourceLinks.forEach((function(t){t.y0=e+t.width/2,e+=t.width})),t.targetLinks.forEach((function(t){t.y1=n+t.width/2,n+=t.width}))}))}return E.update=function(t){return R(t),t},E.nodeId=function(t){return arguments.length?(u="function"==typeof t?t:s(t),E):u},E.nodeAlign=function(t){return arguments.length?(_="function"==typeof t?t:s(t),E):_},E.nodeWidth=function(t){return arguments.length?(o=+t,E):o},E.nodePadding=function(t){return arguments.length?(l=+t,E):l},E.nodes=function(t){return arguments.length?(b="function"==typeof t?t:s(t),E):b},E.links=function(t){return arguments.length?(w="function"==typeof t?t:s(t),E):w},E.size=function(r){return arguments.length?(t=e=0,n=+r[0],i=+r[1],E):[n-t,i-e]},E.extent=function(r){return arguments.length?(t=+r[0][0],n=+r[1][0],e=+r[0][1],i=+r[1][1],E):[[t,e],[n,i]]},E.iterations=function(t){return arguments.length?(A=+t,E):A},E}var b=n(1861);function w(t){return[t.source.x1,t.y0]}function A(t){return[t.target.x0,t.y1]}function E(){return(0,b.h5)().source(w).target(A)}},61079:(t,e,n)=>{"use strict";function r(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}var a,i;n.d(e,{j2:()=>r,Fp:()=>l,J6:()=>u,VV:()=>s,Sm:()=>f}),1===(a=r).length&&(i=a,a=function(t,e){return r(i(t),e)});var o=Array.prototype;function l(t,e){var n,r,a=t.length,i=-1;if(null==e){for(;++i<a;)if(null!=(n=t[i])&&n>=n)for(r=n;++i<a;)null!=(n=t[i])&&n>r&&(r=n)}else for(;++i<a;)if(null!=(n=e(t[i],i,t))&&n>=n)for(r=n;++i<a;)null!=(n=e(t[i],i,t))&&n>r&&(r=n);return r}function c(t){return null===t?NaN:+t}function u(t,e){var n,r=t.length,a=r,i=-1,o=0;if(null==e)for(;++i<r;)isNaN(n=c(t[i]))?--a:o+=n;else for(;++i<r;)isNaN(n=c(e(t[i],i,t)))?--a:o+=n;if(a)return o/a}function s(t,e){var n,r,a=t.length,i=-1;if(null==e){for(;++i<a;)if(null!=(n=t[i])&&n>=n)for(r=n;++i<a;)null!=(n=t[i])&&r>n&&(r=n)}else for(;++i<a;)if(null!=(n=e(t[i],i,t))&&n>=n)for(r=n;++i<a;)null!=(n=e(t[i],i,t))&&r>n&&(r=n);return r}function f(t,e){var n,r=t.length,a=-1,i=0;if(null==e)for(;++a<r;)(n=+t[a])&&(i+=n);else for(;++a<r;)(n=+e(t[a],a,t))&&(i+=n);return i}o.slice,o.map,Math.sqrt(50),Math.sqrt(10),Math.sqrt(2)},31654:(t,e,n)=>{"use strict";n.d(e,{UI:()=>o,b1:()=>l});var r="$";function a(){}function i(t,e){var n=new a;if(t instanceof a)t.each((function(t,e){n.set(e,t)}));else if(Array.isArray(t)){var r,i=-1,o=t.length;if(null==e)for(;++i<o;)n.set(i,t[i]);else for(;++i<o;)n.set(e(r=t[i],i,t),r)}else if(t)for(var l in t)n.set(l,t[l]);return n}a.prototype=i.prototype={constructor:a,has:function(t){return r+t in this},get:function(t){return this[r+t]},set:function(t,e){return this[r+t]=e,this},remove:function(t){var e=r+t;return e in this&&delete this[e]},clear:function(){for(var t in this)t[0]===r&&delete this[t]},keys:function(){var t=[];for(var e in this)e[0]===r&&t.push(e.slice(1));return t},values:function(){var t=[];for(var e in this)e[0]===r&&t.push(this[e]);return t},entries:function(){var t=[];for(var e in this)e[0]===r&&t.push({key:e.slice(1),value:this[e]});return t},size:function(){var t=0;for(var e in this)e[0]===r&&++t;return t},empty:function(){for(var t in this)if(t[0]===r)return!1;return!0},each:function(t){for(var e in this)e[0]===r&&t(this[e],e.slice(1),this)}};const o=i;function l(){var t,e,n,r=[],a=[];function i(n,a,l,c){if(a>=r.length)return null!=t&&n.sort(t),null!=e?e(n):n;for(var u,s,f,h=-1,d=n.length,y=r[a++],g=o(),p=l();++h<d;)(f=g.get(u=y(s=n[h])+""))?f.push(s):g.set(u,[s]);return g.each((function(t,e){c(p,e,i(t,a,l,c))})),p}function l(t,n){if(++n>r.length)return t;var i,o=a[n-1];return null!=e&&n>=r.length?i=t.entries():(i=[],t.each((function(t,e){i.push({key:e,values:l(t,n)})}))),null!=o?i.sort((function(t,e){return o(t.key,e.key)})):i}return n={object:function(t){return i(t,0,c,u)},map:function(t){return i(t,0,s,f)},entries:function(t){return l(i(t,0,s,f),0)},key:function(t){return r.push(t),n},sortKeys:function(t){return a[r.length-1]=t,n},sortValues:function(e){return t=e,n},rollup:function(t){return e=t,n}}}function c(){return{}}function u(t,e,n){t[e]=n}function s(){return o()}function f(t,e,n){t.set(e,n)}function h(){}var d=o.prototype;h.prototype=function(t,e){var n=new h;if(t instanceof h)t.each((function(t){n.add(t)}));else if(t){var r=-1,a=t.length;if(null==e)for(;++r<a;)n.add(t[r]);else for(;++r<a;)n.add(e(t[r],r,t))}return n}.prototype={constructor:h,has:d.has,add:function(t){return this[r+(t+="")]=t,this},remove:d.remove,clear:d.clear,values:d.keys,size:d.size,empty:d.empty,each:d.each}},51922:(t,e,n)=>{"use strict";function r(t,e){var n;function r(){var r,a,i=n.length,o=0,l=0;for(r=0;r<i;++r)o+=(a=n[r]).x,l+=a.y;for(o=o/i-t,l=l/i-e,r=0;r<i;++r)(a=n[r]).x-=o,a.y-=l}return null==t&&(t=0),null==e&&(e=0),r.initialize=function(t){n=t},r.x=function(e){return arguments.length?(t=+e,r):t},r.y=function(t){return arguments.length?(e=+t,r):e},r}function a(t){return function(){return t}}function i(){return 1e-6*(Math.random()-.5)}function o(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var a,i,o,l,c,u,s,f,h,d=t._root,y={data:r},g=t._x0,p=t._y0,v=t._x1,x=t._y1;if(!d)return t._root=y,t;for(;d.length;)if((u=e>=(i=(g+v)/2))?g=i:v=i,(s=n>=(o=(p+x)/2))?p=o:x=o,a=d,!(d=d[f=s<<1|u]))return a[f]=y,t;if(l=+t._x.call(null,d.data),c=+t._y.call(null,d.data),e===l&&n===c)return y.next=d,a?a[f]=y:t._root=y,t;do{a=a?a[f]=new Array(4):t._root=new Array(4),(u=e>=(i=(g+v)/2))?g=i:v=i,(s=n>=(o=(p+x)/2))?p=o:x=o}while((f=s<<1|u)==(h=(c>=o)<<1|l>=i));return a[h]=d,a[f]=y,t}function l(t,e,n,r,a){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=a}function c(t){return t[0]}function u(t){return t[1]}function s(t,e,n){var r=new f(null==e?c:e,null==n?u:n,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function f(t,e,n,r,a,i){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=a,this._y1=i,this._root=void 0}function h(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}n.r(e),n.d(e,{forceCenter:()=>r,forceCollide:()=>p,forceLink:()=>m,forceManyBody:()=>J,forceRadial:()=>Z,forceSimulation:()=>U,forceX:()=>K,forceY:()=>Q});var d=s.prototype=f.prototype;function y(t){return t.x+t.vx}function g(t){return t.y+t.vy}function p(t){var e,n,r=1,o=1;function l(){for(var t,a,l,u,f,h,d,p=e.length,v=0;v<o;++v)for(a=s(e,y,g).visitAfter(c),t=0;t<p;++t)l=e[t],h=n[l.index],d=h*h,u=l.x+l.vx,f=l.y+l.vy,a.visit(x);function x(t,e,n,a,o){var c=t.data,s=t.r,y=h+s;if(!c)return e>u+y||a<u-y||n>f+y||o<f-y;if(c.index>l.index){var g=u-c.x-c.vx,p=f-c.y-c.vy,v=g*g+p*p;v<y*y&&(0===g&&(v+=(g=i())*g),0===p&&(v+=(p=i())*p),v=(y-(v=Math.sqrt(v)))/v*r,l.vx+=(g*=v)*(y=(s*=s)/(d+s)),l.vy+=(p*=v)*y,c.vx-=g*(y=1-y),c.vy-=p*y)}}}function c(t){if(t.data)return t.r=n[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function u(){if(e){var r,a,i=e.length;for(n=new Array(i),r=0;r<i;++r)a=e[r],n[a.index]=+t(a,r,e)}}return"function"!=typeof t&&(t=a(null==t?1:+t)),l.initialize=function(t){e=t,u()},l.iterations=function(t){return arguments.length?(o=+t,l):o},l.strength=function(t){return arguments.length?(r=+t,l):r},l.radius=function(e){return arguments.length?(t="function"==typeof e?e:a(+e),u(),l):t},l}d.copy=function(){var t,e,n=new f(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=h(r),n;for(t=[{source:r,target:n._root=new Array(4)}];r=t.pop();)for(var a=0;a<4;++a)(e=r.source[a])&&(e.length?t.push({source:e,target:r.target[a]=new Array(4)}):r.target[a]=h(e));return n},d.add=function(t){var e=+this._x.call(null,t),n=+this._y.call(null,t);return o(this.cover(e,n),e,n,t)},d.addAll=function(t){var e,n,r,a,i=t.length,l=new Array(i),c=new Array(i),u=1/0,s=1/0,f=-1/0,h=-1/0;for(n=0;n<i;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(a=+this._y.call(null,e))||(l[n]=r,c[n]=a,r<u&&(u=r),r>f&&(f=r),a<s&&(s=a),a>h&&(h=a));if(u>f||s>h)return this;for(this.cover(u,s).cover(f,h),n=0;n<i;++n)o(this,l[n],c[n],t[n]);return this},d.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,a=this._x1,i=this._y1;if(isNaN(n))a=(n=Math.floor(t))+1,i=(r=Math.floor(e))+1;else{for(var o,l,c=a-n,u=this._root;n>t||t>=a||r>e||e>=i;)switch(l=(e<r)<<1|t<n,(o=new Array(4))[l]=u,u=o,c*=2,l){case 0:a=n+c,i=r+c;break;case 1:n=a-c,i=r+c;break;case 2:a=n+c,r=i-c;break;case 3:n=a-c,r=i-c}this._root&&this._root.length&&(this._root=u)}return this._x0=n,this._y0=r,this._x1=a,this._y1=i,this},d.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},d.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},d.find=function(t,e,n){var r,a,i,o,c,u,s,f=this._x0,h=this._y0,d=this._x1,y=this._y1,g=[],p=this._root;for(p&&g.push(new l(p,f,h,d,y)),null==n?n=1/0:(f=t-n,h=e-n,d=t+n,y=e+n,n*=n);u=g.pop();)if(!(!(p=u.node)||(a=u.x0)>d||(i=u.y0)>y||(o=u.x1)<f||(c=u.y1)<h))if(p.length){var v=(a+o)/2,x=(i+c)/2;g.push(new l(p[3],v,x,o,c),new l(p[2],a,x,v,c),new l(p[1],v,i,o,x),new l(p[0],a,i,v,x)),(s=(e>=x)<<1|t>=v)&&(u=g[g.length-1],g[g.length-1]=g[g.length-1-s],g[g.length-1-s]=u)}else{var k=t-+this._x.call(null,p.data),m=e-+this._y.call(null,p.data),L=k*k+m*m;if(L<n){var _=Math.sqrt(n=L);f=t-_,h=e-_,d=t+_,y=e+_,r=p.data}}return r},d.remove=function(t){if(isNaN(i=+this._x.call(null,t))||isNaN(o=+this._y.call(null,t)))return this;var e,n,r,a,i,o,l,c,u,s,f,h,d=this._root,y=this._x0,g=this._y0,p=this._x1,v=this._y1;if(!d)return this;if(d.length)for(;;){if((u=i>=(l=(y+p)/2))?y=l:p=l,(s=o>=(c=(g+v)/2))?g=c:v=c,e=d,!(d=d[f=s<<1|u]))return this;if(!d.length)break;(e[f+1&3]||e[f+2&3]||e[f+3&3])&&(n=e,h=f)}for(;d.data!==t;)if(r=d,!(d=d.next))return this;return(a=d.next)&&delete d.next,r?(a?r.next=a:delete r.next,this):e?(a?e[f]=a:delete e[f],(d=e[0]||e[1]||e[2]||e[3])&&d===(e[3]||e[2]||e[1]||e[0])&&!d.length&&(n?n[h]=d:this._root=d),this):(this._root=a,this)},d.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},d.root=function(){return this._root},d.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},d.visit=function(t){var e,n,r,a,i,o,c=[],u=this._root;for(u&&c.push(new l(u,this._x0,this._y0,this._x1,this._y1));e=c.pop();)if(!t(u=e.node,r=e.x0,a=e.y0,i=e.x1,o=e.y1)&&u.length){var s=(r+i)/2,f=(a+o)/2;(n=u[3])&&c.push(new l(n,s,f,i,o)),(n=u[2])&&c.push(new l(n,r,f,s,o)),(n=u[1])&&c.push(new l(n,s,a,i,f)),(n=u[0])&&c.push(new l(n,r,a,s,f))}return this},d.visitAfter=function(t){var e,n=[],r=[];for(this._root&&n.push(new l(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var a=e.node;if(a.length){var i,o=e.x0,c=e.y0,u=e.x1,s=e.y1,f=(o+u)/2,h=(c+s)/2;(i=a[0])&&n.push(new l(i,o,c,f,h)),(i=a[1])&&n.push(new l(i,f,c,u,h)),(i=a[2])&&n.push(new l(i,o,h,f,s)),(i=a[3])&&n.push(new l(i,f,h,u,s))}r.push(e)}for(;e=r.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},d.x=function(t){return arguments.length?(this._x=t,this):this._x},d.y=function(t){return arguments.length?(this._y=t,this):this._y};var v=n(31654);function x(t){return t.index}function k(t,e){var n=t.get(e);if(!n)throw new Error("missing: "+e);return n}function m(t){var e,n,r,o,l,c=x,u=function(t){return 1/Math.min(o[t.source.index],o[t.target.index])},s=a(30),f=1;function h(r){for(var a=0,o=t.length;a<f;++a)for(var c,u,s,h,d,y,g,p=0;p<o;++p)u=(c=t[p]).source,h=(s=c.target).x+s.vx-u.x-u.vx||i(),d=s.y+s.vy-u.y-u.vy||i(),h*=y=((y=Math.sqrt(h*h+d*d))-n[p])/y*r*e[p],d*=y,s.vx-=h*(g=l[p]),s.vy-=d*g,u.vx+=h*(g=1-g),u.vy+=d*g}function d(){if(r){var a,i,u=r.length,s=t.length,f=(0,v.UI)(r,c);for(a=0,o=new Array(u);a<s;++a)(i=t[a]).index=a,"object"!=typeof i.source&&(i.source=k(f,i.source)),"object"!=typeof i.target&&(i.target=k(f,i.target)),o[i.source.index]=(o[i.source.index]||0)+1,o[i.target.index]=(o[i.target.index]||0)+1;for(a=0,l=new Array(s);a<s;++a)i=t[a],l[a]=o[i.source.index]/(o[i.source.index]+o[i.target.index]);e=new Array(s),y(),n=new Array(s),g()}}function y(){if(r)for(var n=0,a=t.length;n<a;++n)e[n]=+u(t[n],n,t)}function g(){if(r)for(var e=0,a=t.length;e<a;++e)n[e]=+s(t[e],e,t)}return null==t&&(t=[]),h.initialize=function(t){r=t,d()},h.links=function(e){return arguments.length?(t=e,d(),h):t},h.id=function(t){return arguments.length?(c=t,h):c},h.iterations=function(t){return arguments.length?(f=+t,h):f},h.strength=function(t){return arguments.length?(u="function"==typeof t?t:a(+t),y(),h):u},h.distance=function(t){return arguments.length?(s="function"==typeof t?t:a(+t),g(),h):s},h}var L={value:function(){}};function _(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new b(r)}function b(t){this._=t}function w(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}function A(t,e){for(var n,r=0,a=t.length;r<a;++r)if((n=t[r]).name===e)return n.value}function E(t,e,n){for(var r=0,a=t.length;r<a;++r)if(t[r].name===e){t[r]=L,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}b.prototype=_.prototype={constructor:b,on:function(t,e){var n,r=this._,a=w(t+"",r),i=-1,o=a.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++i<o;)if(n=(t=a[i]).type)r[n]=E(r[n],t.name,e);else if(null==e)for(n in r)r[n]=E(r[n],t.name,null);return this}for(;++i<o;)if((n=(t=a[i]).type)&&(n=A(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new b(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,a=new Array(n),i=0;i<n;++i)a[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(i=0,n=(r=this._[t]).length;i<n;++i)r[i].value.apply(e,a)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],a=0,i=r.length;a<i;++a)r[a].value.apply(e,n)}};const P=_;var D,T,I=0,R=0,S=0,N=0,F=0,M=0,C="object"==typeof performance&&performance.now?performance:Date,O="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function z(){return F||(O(Y),F=C.now()+M)}function Y(){F=0}function j(){this._call=this._time=this._next=null}function X(t,e,n){var r=new j;return r.restart(t,e,n),r}function B(){F=(N=C.now())+M,I=R=0;try{!function(){z(),++I;for(var t,e=D;e;)(t=F-e._time)>=0&&e._call.call(null,t),e=e._next;--I}()}finally{I=0,function(){for(var t,e,n=D,r=1/0;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:D=e);T=t,H(r)}(),F=0}}function q(){var t=C.now(),e=t-N;e>1e3&&(M-=e,N=t)}function H(t){I||(R&&(R=clearTimeout(R)),t-F>24?(t<1/0&&(R=setTimeout(B,t-C.now()-M)),S&&(S=clearInterval(S))):(S||(N=C.now(),S=setInterval(q,1e3)),I=1,O(B)))}function W(t){return t.x}function G(t){return t.y}j.prototype=X.prototype={constructor:j,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?z():+n)+(null==e?0:+e),this._next||T===this||(T?T._next=this:D=this,T=this),this._call=t,this._time=n,H()},stop:function(){this._call&&(this._call=null,this._time=1/0,H())}};var V=Math.PI*(3-Math.sqrt(5));function U(t){var e,n=1,r=.001,a=1-Math.pow(r,1/300),i=0,o=.6,l=(0,v.UI)(),c=X(s),u=P("tick","end");function s(){f(),u.call("tick",e),n<r&&(c.stop(),u.call("end",e))}function f(r){var c,u,s=t.length;void 0===r&&(r=1);for(var f=0;f<r;++f)for(n+=(i-n)*a,l.each((function(t){t(n)})),c=0;c<s;++c)null==(u=t[c]).fx?u.x+=u.vx*=o:(u.x=u.fx,u.vx=0),null==u.fy?u.y+=u.vy*=o:(u.y=u.fy,u.vy=0);return e}function h(){for(var e,n=0,r=t.length;n<r;++n){if((e=t[n]).index=n,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var a=10*Math.sqrt(n),i=n*V;e.x=a*Math.cos(i),e.y=a*Math.sin(i)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function d(e){return e.initialize&&e.initialize(t),e}return null==t&&(t=[]),h(),e={tick:f,restart:function(){return c.restart(s),e},stop:function(){return c.stop(),e},nodes:function(n){return arguments.length?(t=n,h(),l.each(d),e):t},alpha:function(t){return arguments.length?(n=+t,e):n},alphaMin:function(t){return arguments.length?(r=+t,e):r},alphaDecay:function(t){return arguments.length?(a=+t,e):+a},alphaTarget:function(t){return arguments.length?(i=+t,e):i},velocityDecay:function(t){return arguments.length?(o=1-t,e):1-o},force:function(t,n){return arguments.length>1?(null==n?l.remove(t):l.set(t,d(n)),e):l.get(t)},find:function(e,n,r){var a,i,o,l,c,u=0,s=t.length;for(null==r?r=1/0:r*=r,u=0;u<s;++u)(o=(a=e-(l=t[u]).x)*a+(i=n-l.y)*i)<r&&(c=l,r=o);return c},on:function(t,n){return arguments.length>1?(u.on(t,n),e):u.on(t)}}}function J(){var t,e,n,r,o=a(-30),l=1,c=1/0,u=.81;function f(r){var a,i=t.length,o=s(t,W,G).visitAfter(d);for(n=r,a=0;a<i;++a)e=t[a],o.visit(y)}function h(){if(t){var e,n,a=t.length;for(r=new Array(a),e=0;e<a;++e)n=t[e],r[n.index]=+o(n,e,t)}}function d(t){var e,n,a,i,o,l=0,c=0;if(t.length){for(a=i=o=0;o<4;++o)(e=t[o])&&(n=Math.abs(e.value))&&(l+=e.value,c+=n,a+=n*e.x,i+=n*e.y);t.x=a/c,t.y=i/c}else{(e=t).x=e.data.x,e.y=e.data.y;do{l+=r[e.data.index]}while(e=e.next)}t.value=l}function y(t,a,o,s){if(!t.value)return!0;var f=t.x-e.x,h=t.y-e.y,d=s-a,y=f*f+h*h;if(d*d/u<y)return y<c&&(0===f&&(y+=(f=i())*f),0===h&&(y+=(h=i())*h),y<l&&(y=Math.sqrt(l*y)),e.vx+=f*t.value*n/y,e.vy+=h*t.value*n/y),!0;if(!(t.length||y>=c)){(t.data!==e||t.next)&&(0===f&&(y+=(f=i())*f),0===h&&(y+=(h=i())*h),y<l&&(y=Math.sqrt(l*y)));do{t.data!==e&&(d=r[t.data.index]*n/y,e.vx+=f*d,e.vy+=h*d)}while(t=t.next)}}return f.initialize=function(e){t=e,h()},f.strength=function(t){return arguments.length?(o="function"==typeof t?t:a(+t),h(),f):o},f.distanceMin=function(t){return arguments.length?(l=t*t,f):Math.sqrt(l)},f.distanceMax=function(t){return arguments.length?(c=t*t,f):Math.sqrt(c)},f.theta=function(t){return arguments.length?(u=t*t,f):Math.sqrt(u)},f}function Z(t,e,n){var r,i,o,l=a(.1);function c(t){for(var a=0,l=r.length;a<l;++a){var c=r[a],u=c.x-e||1e-6,s=c.y-n||1e-6,f=Math.sqrt(u*u+s*s),h=(o[a]-f)*i[a]*t/f;c.vx+=u*h,c.vy+=s*h}}function u(){if(r){var e,n=r.length;for(i=new Array(n),o=new Array(n),e=0;e<n;++e)o[e]=+t(r[e],e,r),i[e]=isNaN(o[e])?0:+l(r[e],e,r)}}return"function"!=typeof t&&(t=a(+t)),null==e&&(e=0),null==n&&(n=0),c.initialize=function(t){r=t,u()},c.strength=function(t){return arguments.length?(l="function"==typeof t?t:a(+t),u(),c):l},c.radius=function(e){return arguments.length?(t="function"==typeof e?e:a(+e),u(),c):t},c.x=function(t){return arguments.length?(e=+t,c):e},c.y=function(t){return arguments.length?(n=+t,c):n},c}function K(t){var e,n,r,i=a(.1);function o(t){for(var a,i=0,o=e.length;i<o;++i)(a=e[i]).vx+=(r[i]-a.x)*n[i]*t}function l(){if(e){var a,o=e.length;for(n=new Array(o),r=new Array(o),a=0;a<o;++a)n[a]=isNaN(r[a]=+t(e[a],a,e))?0:+i(e[a],a,e)}}return"function"!=typeof t&&(t=a(null==t?0:+t)),o.initialize=function(t){e=t,l()},o.strength=function(t){return arguments.length?(i="function"==typeof t?t:a(+t),l(),o):i},o.x=function(e){return arguments.length?(t="function"==typeof e?e:a(+e),l(),o):t},o}function Q(t){var e,n,r,i=a(.1);function o(t){for(var a,i=0,o=e.length;i<o;++i)(a=e[i]).vy+=(r[i]-a.y)*n[i]*t}function l(){if(e){var a,o=e.length;for(n=new Array(o),r=new Array(o),a=0;a<o;++a)n[a]=isNaN(r[a]=+t(e[a],a,e))?0:+i(e[a],a,e)}}return"function"!=typeof t&&(t=a(null==t?0:+t)),o.initialize=function(t){e=t,l()},o.strength=function(t){return arguments.length?(i="function"==typeof t?t:a(+t),l(),o):i},o.y=function(e){return arguments.length?(t="function"==typeof e?e:a(+e),l(),o):t},o}},70448:(t,e,n)=>{"use strict";function r(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}n.d(e,{k4:()=>r})},1861:(t,e,n)=>{"use strict";n.d(e,{h5:()=>v});var r=Math.PI,a=2*r,i=1e-6,o=a-i;function l(){this._x0=this._y0=this._x1=this._y1=null,this._=""}function c(){return new l}l.prototype=c.prototype={constructor:l,moveTo:function(t,e){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)},closePath:function(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")},lineTo:function(t,e){this._+="L"+(this._x1=+t)+","+(this._y1=+e)},quadraticCurveTo:function(t,e,n,r){this._+="Q"+ +t+","+ +e+","+(this._x1=+n)+","+(this._y1=+r)},bezierCurveTo:function(t,e,n,r,a,i){this._+="C"+ +t+","+ +e+","+ +n+","+ +r+","+(this._x1=+a)+","+(this._y1=+i)},arcTo:function(t,e,n,a,o){t=+t,e=+e,n=+n,a=+a,o=+o;var l=this._x1,c=this._y1,u=n-t,s=a-e,f=l-t,h=c-e,d=f*f+h*h;if(o<0)throw new Error("negative radius: "+o);if(null===this._x1)this._+="M"+(this._x1=t)+","+(this._y1=e);else if(d>i)if(Math.abs(h*u-s*f)>i&&o){var y=n-l,g=a-c,p=u*u+s*s,v=y*y+g*g,x=Math.sqrt(p),k=Math.sqrt(d),m=o*Math.tan((r-Math.acos((p+d-v)/(2*x*k)))/2),L=m/k,_=m/x;Math.abs(L-1)>i&&(this._+="L"+(t+L*f)+","+(e+L*h)),this._+="A"+o+","+o+",0,0,"+ +(h*y>f*g)+","+(this._x1=t+_*u)+","+(this._y1=e+_*s)}else this._+="L"+(this._x1=t)+","+(this._y1=e)},arc:function(t,e,n,l,c,u){t=+t,e=+e,u=!!u;var s=(n=+n)*Math.cos(l),f=n*Math.sin(l),h=t+s,d=e+f,y=1^u,g=u?l-c:c-l;if(n<0)throw new Error("negative radius: "+n);null===this._x1?this._+="M"+h+","+d:(Math.abs(this._x1-h)>i||Math.abs(this._y1-d)>i)&&(this._+="L"+h+","+d),n&&(g<0&&(g=g%a+a),g>o?this._+="A"+n+","+n+",0,1,"+y+","+(t-s)+","+(e-f)+"A"+n+","+n+",0,1,"+y+","+(this._x1=h)+","+(this._y1=d):g>i&&(this._+="A"+n+","+n+",0,"+ +(g>=r)+","+y+","+(this._x1=t+n*Math.cos(c))+","+(this._y1=e+n*Math.sin(c))))},rect:function(t,e,n,r){this._+="M"+(this._x0=this._x1=+t)+","+(this._y0=this._y1=+e)+"h"+ +n+"v"+ +r+"h"+-n+"Z"},toString:function(){return this._}};const u=c;var s=Array.prototype.slice;function f(t){return function(){return t}}function h(t){return t[0]}function d(t){return t[1]}function y(t){return t.source}function g(t){return t.target}function p(t,e,n,r,a){t.moveTo(e,n),t.bezierCurveTo(e=(e+r)/2,n,e,a,r,a)}function v(){return function(t){var e=y,n=g,r=h,a=d,i=null;function o(){var o,l=s.call(arguments),c=e.apply(this,l),f=n.apply(this,l);if(i||(i=o=u()),t(i,+r.apply(this,(l[0]=c,l)),+a.apply(this,l),+r.apply(this,(l[0]=f,l)),+a.apply(this,l)),o)return i=null,o+""||null}return o.source=function(t){return arguments.length?(e=t,o):e},o.target=function(t){return arguments.length?(n=t,o):n},o.x=function(t){return arguments.length?(r="function"==typeof t?t:f(+t),o):r},o.y=function(t){return arguments.length?(a="function"==typeof t?t:f(+t),o):a},o.context=function(t){return arguments.length?(i=null==t?null:t,o):i},o}(p)}},23889:(t,e,n)=>{var r=n(52617);t.exports=function(t,e){var n,a=[],i=[],o=[],l={},c=[];function u(t){o[t]=!1,l.hasOwnProperty(t)&&Object.keys(l[t]).forEach((function(e){delete l[t][e],o[e]&&u(e)}))}function s(t){var e,r,a=!1;for(i.push(t),o[t]=!0,e=0;e<c[t].length;e++)(r=c[t][e])===n?(f(n,i),a=!0):o[r]||(a=s(r));if(a)u(t);else for(e=0;e<c[t].length;e++){r=c[t][e];var h=l[r];h||(h={},l[r]=h),h[r]=!0}return i.pop(),a}function f(t,n){var r=[].concat(n).concat(t);e?e(s):a.push(r)}function h(e){!function(e){for(var n=0;n<t.length;n++)n<e&&(t[n]=[]),t[n]=t[n].filter((function(t){return t>=e}))}(e);for(var n,a=r(t).components.filter((function(t){return t.length>1})),i=1/0,o=0;o<a.length;o++)for(var l=0;l<a[o].length;l++)a[o][l]<i&&(i=a[o][l],n=o);var c=a[n];if(!c)return!1;var u=t.map((function(t,e){return-1===c.indexOf(e)?[]:t.filter((function(t){return-1!==c.indexOf(t)}))}));return{leastVertex:i,adjList:u}}n=0;for(var d=t.length;n<d;){var y=h(n);if(n=y.leastVertex,c=y.adjList){for(var g=0;g<c.length;g++)for(var p=0;p<c[g].length;p++){var v=c[g][p];o[+v]=!1,l[v]={}}s(n),n+=1}else n=d}return e?void 0:a}},43980:(t,e,n)=>{"use strict";t.exports=n(68685)},38241:(t,e,n)=>{"use strict";var r=n(38003),a=n(85485),i=n(28604),o=n(34702),l=n(72910).Y,c=n(88176).f,u=n(85088),s=n(18882).templatedArray,f=n(94867).extendFlat,h=n(15716).overrideAll,d=n(59904).FORMAT_LINK;(t.exports=h({hoverinfo:f({},a.hoverinfo,{flags:[],arrayOk:!1,description:["Determines which trace information appear on hover.","If `none` or `skip` are set, no information is displayed upon hovering.","But, if `none` is set, click and hover events are still fired.","Note that this attribute is superseded by `node.hoverinfo` and `node.hoverinfo`","for nodes and links respectively."].join(" ")}),hoverlabel:o.hoverlabel,domain:l({name:"sankey",trace:!0}),orientation:{valType:"enumerated",values:["v","h"],dflt:"h",role:"style",description:"Sets the orientation of the Sankey diagram."},valueformat:{valType:"string",dflt:".3s",role:"style",description:["Sets the value formatting rule using d3 formatting mini-language","which is similar to those of Python. See",d].join(" ")},valuesuffix:{valType:"string",dflt:"",role:"style",description:["Adds a unit to follow the value in the hover tooltip. Add a space if a separation","is necessary from the value."].join(" ")},arrangement:{valType:"enumerated",values:["snap","perpendicular","freeform","fixed"],dflt:"snap",role:"style",description:["If value is `snap` (the default), the node arrangement is assisted by automatic snapping of elements to","preserve space between nodes specified via `nodepad`.","If value is `perpendicular`, the nodes can only move along a line perpendicular to the flow.","If value is `freeform`, the nodes can freely move on the plane.","If value is `fixed`, the nodes are stationary."].join(" ")},textfont:r({description:"Sets the font for node labels"}),customdata:void 0,node:{label:{valType:"data_array",dflt:[],role:"info",description:"The shown name of the node."},groups:{valType:"info_array",impliedEdits:{x:[],y:[]},dimensions:2,freeLength:!0,dflt:[],items:{valType:"number",editType:"calc"},role:"info",description:["Groups of nodes.","Each group is defined by an array with the indices of the nodes it contains.","Multiple groups can be specified."].join(" ")},x:{valType:"data_array",dflt:[],role:"info",description:"The normalized horizontal position of the node."},y:{valType:"data_array",dflt:[],role:"info",description:"The normalized vertical position of the node."},color:{valType:"color",role:"style",arrayOk:!0,description:["Sets the `node` color. It can be a single value, or an array for specifying color for each `node`.","If `node.color` is omitted, then the default `Plotly` color palette will be cycled through","to have a variety of colors. These defaults are not fully opaque, to allow some visibility of","what is beneath the node."].join(" ")},customdata:{valType:"data_array",editType:"calc",description:["Assigns extra data to each node."].join(" ")},line:{color:{valType:"color",role:"style",dflt:i.defaultLine,arrayOk:!0,description:["Sets the color of the `line` around each `node`."].join(" ")},width:{valType:"number",role:"style",min:0,dflt:.5,arrayOk:!0,description:["Sets the width (in px) of the `line` around each `node`."].join(" ")}},pad:{valType:"number",arrayOk:!1,min:0,dflt:20,role:"style",description:"Sets the padding (in px) between the `nodes`."},thickness:{valType:"number",arrayOk:!1,min:1,dflt:20,role:"style",description:"Sets the thickness (in px) of the `nodes`."},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all",role:"info",description:["Determines which trace information appear when hovering nodes.","If `none` or `skip` are set, no information is displayed upon hovering.","But, if `none` is set, click and hover events are still fired."].join(" ")},hoverlabel:o.hoverlabel,hovertemplate:c({},{description:"Variables `sourceLinks` and `targetLinks` are arrays of link objects.",keys:["value","label"]}),description:"The nodes of the Sankey plot."},link:{label:{valType:"data_array",dflt:[],role:"info",description:"The shown name of the link."},color:{valType:"color",role:"style",arrayOk:!0,description:["Sets the `link` color. It can be a single value, or an array for specifying color for each `link`.","If `link.color` is omitted, then by default, a translucent grey link will be used."].join(" ")},customdata:{valType:"data_array",editType:"calc",description:["Assigns extra data to each link."].join(" ")},line:{color:{valType:"color",role:"style",dflt:i.defaultLine,arrayOk:!0,description:["Sets the color of the `line` around each `link`."].join(" ")},width:{valType:"number",role:"style",min:0,dflt:0,arrayOk:!0,description:["Sets the width (in px) of the `line` around each `link`."].join(" ")}},source:{valType:"data_array",role:"info",dflt:[],description:"An integer number `[0..nodes.length - 1]` that represents the source node."},target:{valType:"data_array",role:"info",dflt:[],description:"An integer number `[0..nodes.length - 1]` that represents the target node."},value:{valType:"data_array",dflt:[],role:"info",description:"A numeric value representing the flow volume value."},hoverinfo:{valType:"enumerated",values:["all","none","skip"],dflt:"all",role:"info",description:["Determines which trace information appear when hovering links.","If `none` or `skip` are set, no information is displayed upon hovering.","But, if `none` is set, click and hover events are still fired."].join(" ")},hoverlabel:o.hoverlabel,hovertemplate:c({},{description:"Variables `source` and `target` are node objects.",keys:["value","label"]}),colorscales:s("concentrationscales",{editType:"calc",label:{valType:"string",role:"info",editType:"calc",description:"The label of the links to color based on their concentration within a flow.",dflt:""},cmax:{valType:"number",role:"info",editType:"calc",dflt:1,description:["Sets the upper bound of the color domain."].join("")},cmin:{valType:"number",role:"info",editType:"calc",dflt:0,description:["Sets the lower bound of the color domain."].join("")},colorscale:f(u().colorscale,{dflt:[[0,"white"],[1,"black"]]})}),description:"The links of the Sankey plot.",role:"info"}},"calc","nested")).transforms=void 0},15795:(t,e,n)=>{"use strict";var r=n(15716).overrideAll,a=n(67763).a0,i=n(85845),o=n(92997),l=n(85813),c=n(86962),u=n(80755).prepSelect,s=n(34141),f=n(97997),h="sankey";function d(t,e){var n=t._fullData[e],r=t._fullLayout,a=r.dragmode,i="pan"===r.dragmode?"move":"crosshair",o=n._bgRect;if("pan"!==a&&"zoom"!==a){l(o,i);var h={_id:"x",c2p:s.identity,_offset:n._sankey.translateX,_length:n._sankey.width},d={_id:"y",c2p:s.identity,_offset:n._sankey.translateY,_length:n._sankey.height},y={gd:t,element:o.node(),plotinfo:{id:e,xaxis:h,yaxis:d,fillRangeItems:s.noop},subplot:e,xaxes:[h],yaxes:[d],doneFnCompleted:function(n){var r,a=t._fullData[e],i=a.node.groups.slice(),o=[];function l(t){for(var e=a._sankey.graph.nodes,n=0;n<e.length;n++)if(e[n].pointNumber===t)return e[n]}for(var c=0;c<n.length;c++){var u=l(n[c].pointNumber);if(u)if(u.group){for(var s=0;s<u.childrenNodes.length;s++)o.push(u.childrenNodes[s].pointNumber);i[u.pointNumber-a.node._count]=!1}else o.push(u.pointNumber)}r=i.filter(Boolean).concat([o]),f.call("_guiRestyle",t,{"node.groups":[r]},e)},prepFn:function(t,e,n){u(t,e,n,y,a)}};c.init(y)}}e.name=h,e.baseLayoutAttrOverrides=r({hoverlabel:o.hoverlabel},"plot","nested"),e.plot=function(t){var n=a(t.calcdata,h)[0];i(t,n),e.updateFx(t)},e.clean=function(t,e,n,r){var a=r._has&&r._has(h),i=e._has&&e._has(h);a&&!i&&(r._paperdiv.selectAll(".sankey").remove(),r._paperdiv.selectAll(".bgsankey").remove())},e.updateFx=function(t){for(var e=0;e<t._fullData.length;e++)d(t,e)}},84837:(t,e,n)=>{"use strict";var r=n(52617),a=n(34141),i=n(77715).wrap,o=a.isArrayOrTypedArray,l=a.isIndex,c=n(59430);t.exports=function(t,e){var n=function(t){var e,n=t.node,i=t.link,u=[],s=o(i.color),f=o(i.customdata),h={},d={},y=i.colorscales.length;for(e=0;e<y;e++){var g=i.colorscales[e],p=c.extractScale(g,{cLetter:"c"}),v=c.makeColorScaleFunc(p);d[g.label]=v}var x=0;for(e=0;e<i.value.length;e++)i.source[e]>x&&(x=i.source[e]),i.target[e]>x&&(x=i.target[e]);var k,m=x+1;t.node._count=m;var L=t.node.groups,_={};for(e=0;e<L.length;e++){var b=L[e];for(k=0;k<b.length;k++){var w=b[k],A=m+e;_.hasOwnProperty(w)?a.warn("Node "+w+" is already part of a group."):_[w]=A}}var E={source:[],target:[]};for(e=0;e<i.value.length;e++){var P=i.value[e],D=i.source[e],T=i.target[e];if(P>0&&l(D,m)&&l(T,m)&&(!_.hasOwnProperty(D)||!_.hasOwnProperty(T)||_[D]!==_[T])){_.hasOwnProperty(T)&&(T=_[T]),_.hasOwnProperty(D)&&(D=_[D]),T=+T,h[D=+D]=h[T]=!0;var I="";i.label&&i.label[e]&&(I=i.label[e]);var R=null;I&&d.hasOwnProperty(I)&&(R=d[I]),u.push({pointNumber:e,label:I,color:s?i.color[e]:i.color,customdata:f?i.customdata[e]:i.customdata,concentrationscale:R,source:D,target:T,value:+P}),E.source.push(D),E.target.push(T)}}var S=m+L.length,N=o(n.color),F=o(n.customdata),M=[];for(e=0;e<S;e++)if(h[e]){var C=n.label[e];M.push({group:e>m-1,childrenNodes:[],pointNumber:e,label:C,color:N?n.color[e]:n.color,customdata:F?n.customdata[e]:n.customdata})}var O=!1;return function(t,e,n){for(var i=a.init2dArray(t,0),o=0;o<Math.min(e.length,n.length);o++)if(a.isIndex(e[o],t)&&a.isIndex(n[o],t)){if(e[o]===n[o])return!0;i[e[o]].push(n[o])}return r(i).components.some((function(t){return t.length>1}))}(S,E.source,E.target)&&(O=!0),{circular:O,links:u,nodes:M,groups:L,groupLookup:_}}(e);return i({circular:n.circular,_nodes:n.nodes,_links:n.links,_groups:n.groups,_groupLookup:n.groupLookup})}},82856:t=>{"use strict";t.exports={nodeTextOffsetHorizontal:4,nodeTextOffsetVertical:3,nodePadAcross:10,sankeyIterations:50,forceIterations:5,forceTicksPerFrame:10,duration:500,ease:"linear",cn:{sankey:"sankey",sankeyLinks:"sankey-links",sankeyLink:"sankey-link",sankeyNodeSet:"sankey-node-set",sankeyNode:"sankey-node",nodeRect:"node-rect",nodeCapture:"node-capture",nodeCentered:"node-entered",nodeLabelGuide:"node-label-guide",nodeLabel:"node-label",nodeLabelTextPath:"node-label-text-path"}}},19913:(t,e,n)=>{"use strict";var r=n(34141),a=n(38241),i=n(57597),o=n(17621),l=n(72910).c,c=n(93937),u=n(18882),s=n(69337);function f(t,e){function n(n,i){return r.coerce(t,e,a.link.colorscales,n,i)}n("label"),n("cmin"),n("cmax"),n("colorscale")}t.exports=function(t,e,n,h){function d(n,i){return r.coerce(t,e,a,n,i)}var y=r.extendDeep(h.hoverlabel,t.hoverlabel),g=t.node,p=u.newContainer(e,"node");function v(t,e){return r.coerce(g,p,a.node,t,e)}v("label"),v("groups"),v("x"),v("y"),v("pad"),v("thickness"),v("line.color"),v("line.width"),v("hoverinfo",t.hoverinfo),c(g,p,v,y),v("hovertemplate");var x=h.colorway;v("color",p.label.map((function(t,e){return i.addOpacity(function(t){return x[t%x.length]}(e),.8)}))),v("customdata");var k=t.link||{},m=u.newContainer(e,"link");function L(t,e){return r.coerce(k,m,a.link,t,e)}L("label"),L("source"),L("target"),L("value"),L("line.color"),L("line.width"),L("hoverinfo",t.hoverinfo),c(k,m,L,y),L("hovertemplate");var _,b=o(h.paper_bgcolor).getLuminance()<.333?"rgba(255, 255, 255, 0.6)":"rgba(0, 0, 0, 0.2)";L("color",r.repeat(b,m.value.length)),L("customdata"),s(k,m,{name:"colorscales",handleItemDefaults:f}),l(e,h,d),d("orientation"),d("valueformat"),d("valuesuffix"),p.x.length&&p.y.length&&(_="freeform"),d("arrangement",_),r.coerceFont(d,"textfont",r.extendFlat({},h.font)),e._length=null}},68685:(t,e,n)=>{"use strict";t.exports={attributes:n(38241),supplyDefaults:n(19913),calc:n(84837),plot:n(85845),moduleType:"trace",name:"sankey",basePlotModule:n(15795),selectPoints:n(47038),categories:["noOpacity"],meta:{description:["Sankey plots for network flow data analysis.","The nodes are specified in `nodes` and the links between sources and targets in `links`.","The colors are set in `nodes[i].color` and `links[i].color`, otherwise defaults are used."].join(" ")}}},85845:(t,e,n)=>{"use strict";var r=n(15078),a=n(30078),i=n(87529),o=n(57597),l=n(34141),c=n(82856).cn,u=l._;function s(t){return""!==t}function f(t,e){return t.filter((function(t){return t.key===e.traceId}))}function h(t,e){r.select(t).select("path").style("fill-opacity",e),r.select(t).select("rect").style("fill-opacity",e)}function d(t){r.select(t).select("text.name").style("fill","black")}function y(t){return function(e){return-1!==t.node.sourceLinks.indexOf(e.link)||-1!==t.node.targetLinks.indexOf(e.link)}}function g(t){return function(e){return-1!==e.node.sourceLinks.indexOf(t.link)||-1!==e.node.targetLinks.indexOf(t.link)}}function p(t,e,n){e&&n&&f(n,e).selectAll("."+c.sankeyLink).filter(y(e)).call(x.bind(0,e,n,!1))}function v(t,e,n){e&&n&&f(n,e).selectAll("."+c.sankeyLink).filter(y(e)).call(k.bind(0,e,n,!1))}function x(t,e,n,r){var a=r.datum().link.label;r.style("fill-opacity",(function(t){if(!t.link.concentrationscale)return.4})),a&&f(e,t).selectAll("."+c.sankeyLink).filter((function(t){return t.link.label===a})).style("fill-opacity",(function(t){if(!t.link.concentrationscale)return.4})),n&&f(e,t).selectAll("."+c.sankeyNode).filter(g(t)).call(p)}function k(t,e,n,r){var a=r.datum().link.label;r.style("fill-opacity",(function(t){return t.tinyColorAlpha})),a&&f(e,t).selectAll("."+c.sankeyLink).filter((function(t){return t.link.label===a})).style("fill-opacity",(function(t){return t.tinyColorAlpha})),n&&f(e,t).selectAll(c.sankeyNode).filter(g(t)).call(v)}function m(t,e){var n=t.hoverlabel||{},r=l.nestedProperty(n,e).get();return!Array.isArray(r)&&r}t.exports=function(t,e){for(var n=t._fullLayout,l=n._paper,f=n._size,y=0;y<t._fullData.length;y++)if(t._fullData[y].visible&&t._fullData[y].type===c.sankey&&!t._fullData[y]._viewInitial){var g=t._fullData[y].node;t._fullData[y]._viewInitial={node:{groups:g.groups.slice(),x:g.x.slice(),y:g.y.slice()}}}var L=u(t,"source:")+" ",_=u(t,"target:")+" ",b=u(t,"concentration:")+" ",w=u(t,"incoming flow count:")+" ",A=u(t,"outgoing flow count:")+" ";a(t,l,e,{width:f.w,height:f.h,margin:{t:f.t,r:f.r,b:f.b,l:f.l}},{linkEvents:{hover:function(e,n,a){!1!==t._fullLayout.hovermode&&(r.select(e).call(x.bind(0,n,a,!0)),"skip"!==n.link.trace.link.hoverinfo&&(n.link.fullData=n.link.trace,t.emit("plotly_hover",{event:r.event,points:[n.link]})))},follow:function(e,a){if(!1!==t._fullLayout.hovermode){var l=a.link.trace.link;if("none"!==l.hoverinfo&&"skip"!==l.hoverinfo){for(var c=[],u=0,f=0;f<a.flow.links.length;f++){var y=a.flow.links[f];if("closest"!==t._fullLayout.hovermode||a.link.pointNumber===y.pointNumber){a.link.pointNumber===y.pointNumber&&(u=f),y.fullData=y.trace,l=a.link.trace.link;var g=v(y),p={valueLabel:r.format(a.valueFormat)(y.value)+a.valueSuffix};c.push({x:g[0],y:g[1],name:p.valueLabel,text:[y.label||"",L+y.source.label,_+y.target.label,y.concentrationscale?b+r.format("%0.2f")(y.flow.labelConcentration):""].filter(s).join("<br>"),color:m(l,"bgcolor")||o.addOpacity(y.color,1),borderColor:m(l,"bordercolor"),fontFamily:m(l,"font.family"),fontSize:m(l,"font.size"),fontColor:m(l,"font.color"),nameLength:m(l,"namelength"),textAlign:m(l,"align"),idealAlign:r.event.x<g[0]?"right":"left",hovertemplate:l.hovertemplate,hovertemplateLabels:p,eventData:[y]})}}i.loneHover(c,{container:n._hoverlayer.node(),outerContainer:n._paper.node(),gd:t,anchorIndex:u}).each((function(){a.link.concentrationscale||h(this,.65),d(this)}))}}function v(t){var e,n;t.circular?(e=(t.circularPathData.leftInnerExtent+t.circularPathData.rightInnerExtent)/2,n=t.circularPathData.verticalFullExtent):(e=(t.source.x1+t.target.x0)/2,n=(t.y0+t.y1)/2);var r=[e,n];return"v"===t.trace.orientation&&r.reverse(),r[0]+=a.parent.translateX,r[1]+=a.parent.translateY,r}},unhover:function(e,a,o){!1!==t._fullLayout.hovermode&&(r.select(e).call(k.bind(0,a,o,!0)),"skip"!==a.link.trace.link.hoverinfo&&(a.link.fullData=a.link.trace,t.emit("plotly_unhover",{event:r.event,points:[a.link]})),i.loneUnhover(n._hoverlayer.node()))},select:function(e,n){var a=n.link;a.originalEvent=r.event,t._hoverdata=[a],i.click(t,{target:!0})}},nodeEvents:{hover:function(e,n,a){!1!==t._fullLayout.hovermode&&(r.select(e).call(p,n,a),"skip"!==n.node.trace.node.hoverinfo&&(n.node.fullData=n.node.trace,t.emit("plotly_hover",{event:r.event,points:[n.node]})))},follow:function(e,a){if(!1!==t._fullLayout.hovermode){var o=a.node.trace.node;if("none"!==o.hoverinfo&&"skip"!==o.hoverinfo){var l=r.select(e).select("."+c.nodeRect),u=t._fullLayout._paperdiv.node().getBoundingClientRect(),f=l.node().getBoundingClientRect(),y=f.left-2-u.left,g=f.right+2-u.left,p=f.top+f.height/4-u.top,v={valueLabel:r.format(a.valueFormat)(a.node.value)+a.valueSuffix};a.node.fullData=a.node.trace;var x=i.loneHover({x0:y,x1:g,y:p,name:r.format(a.valueFormat)(a.node.value)+a.valueSuffix,text:[a.node.label,w+a.node.targetLinks.length,A+a.node.sourceLinks.length].filter(s).join("<br>"),color:m(o,"bgcolor")||a.tinyColorHue,borderColor:m(o,"bordercolor"),fontFamily:m(o,"font.family"),fontSize:m(o,"font.size"),fontColor:m(o,"font.color"),nameLength:m(o,"namelength"),textAlign:m(o,"align"),idealAlign:"left",hovertemplate:o.hovertemplate,hovertemplateLabels:v,eventData:[a.node]},{container:n._hoverlayer.node(),outerContainer:n._paper.node(),gd:t});h(x,.85),d(x)}}},unhover:function(e,a,o){!1!==t._fullLayout.hovermode&&(r.select(e).call(v,a,o),"skip"!==a.node.trace.node.hoverinfo&&(a.node.fullData=a.node.trace,t.emit("plotly_unhover",{event:r.event,points:[a.node]})),i.loneUnhover(n._hoverlayer.node()))},select:function(e,n,a){var o=n.node;o.originalEvent=r.event,t._hoverdata=[o],r.select(e).call(v,n,a),i.click(t,{target:!0})}}})}},30078:(t,e,n)=>{"use strict";var r=n(82856),a=n(15078),i=n(17621),o=n(57597),l=n(84474),c=n(65589),u=n(94770),s=n(51922),f=n(34141),h=n(77715),d=h.keyFun,y=h.repeat,g=h.unwrap,p=n(70448).k4,v=n(97997);function x(t,e,n){var a,o=g(e),l=o.trace,s=l.domain,h="h"===l.orientation,d=l.node.pad,y=l.node.thickness,p=t.width*(s.x[1]-s.x[0]),v=t.height*(s.y[1]-s.y[0]),x=o._nodes,k=o._links,m=o.circular;(a=m?u.sankeyCircular().circularLinkGap(0):c.sankey()).iterations(r.sankeyIterations).size(h?[p,v]:[v,p]).nodeWidth(y).nodePadding(d).nodeId((function(t){return t.pointNumber})).nodes(x).links(k);var L,_,b,w=a();for(var A in a.nodePadding()<d&&f.warn("node.pad was reduced to ",a.nodePadding()," to fit within the figure."),o._groupLookup){var E,P=parseInt(o._groupLookup[A]);for(L=0;L<w.nodes.length;L++)if(w.nodes[L].pointNumber===P){E=w.nodes[L];break}if(E){var D={pointNumber:parseInt(A),x0:E.x0,x1:E.x1,y0:E.y0,y1:E.y1,partOfGroup:!0,sourceLinks:[],targetLinks:[]};w.nodes.unshift(D),E.childrenNodes.unshift(D)}}if(function(){for(L=0;L<w.nodes.length;L++){var t,e,n=w.nodes[L],r={};for(_=0;_<n.targetLinks.length;_++)t=(e=n.targetLinks[_]).source.pointNumber+":"+e.target.pointNumber,r.hasOwnProperty(t)||(r[t]=[]),r[t].push(e);var a=Object.keys(r);for(_=0;_<a.length;_++){var o=r[t=a[_]],l=0,c={};for(b=0;b<o.length;b++)c[(e=o[b]).label]||(c[e.label]=0),c[e.label]+=e.value,l+=e.value;for(b=0;b<o.length;b++)(e=o[b]).flow={value:l,labelConcentration:c[e.label]/l,concentration:e.value/l,links:o},e.concentrationscale&&(e.color=i(e.concentrationscale(e.flow.labelConcentration)))}var u=0;for(_=0;_<n.sourceLinks.length;_++)u+=n.sourceLinks[_].value;for(_=0;_<n.sourceLinks.length;_++)(e=n.sourceLinks[_]).concentrationOut=e.value/u;var s=0;for(_=0;_<n.targetLinks.length;_++)s+=n.targetLinks[_].value;for(_=0;_<n.targetLinks.length;_++)(e=n.targetLinks[_]).concenrationIn=e.value/s}}(),l.node.x.length&&l.node.y.length){for(L=0;L<Math.min(l.node.x.length,l.node.y.length,w.nodes.length);L++)if(l.node.x[L]&&l.node.y[L]){var T=[l.node.x[L]*p,l.node.y[L]*v];w.nodes[L].x0=T[0]-y/2,w.nodes[L].x1=T[0]+y/2;var I=w.nodes[L].y1-w.nodes[L].y0;w.nodes[L].y0=T[1]-I/2,w.nodes[L].y1=T[1]+I/2}"snap"===l.arrangement&&function(t){var e,n,r=t.map((function(t,e){return{x0:t.x0,index:e}})).sort((function(t,e){return t.x0-e.x0})),a=[],i=-1,o=-1/0;for(L=0;L<r.length;L++){var l=t[r[L].index];l.x0>o+y&&(i+=1,e=l.x0),o=l.x0,a[i]||(a[i]=[]),a[i].push(l),n=e-l.x0,l.x0+=n,l.x1+=n}return a}(x=w.nodes).forEach((function(t){var e,n,r,a=0,i=t.length;for(t.sort((function(t,e){return t.y0-e.y0})),r=0;r<i;++r)(e=t[r]).y0>=a||(n=a-e.y0)>1e-6&&(e.y0+=n,e.y1+=n),a=e.y1+d})),a.update(w)}return{circular:m,key:n,trace:l,guid:f.randstr(),horizontal:h,width:p,height:v,nodePad:l.node.pad,nodeLineColor:l.node.line.color,nodeLineWidth:l.node.line.width,linkLineColor:l.link.line.color,linkLineWidth:l.link.line.width,valueFormat:l.valueformat,valueSuffix:l.valuesuffix,textFont:l.textfont,translateX:s.x[0]*t.width+t.margin.l,translateY:t.height-s.y[1]*t.height+t.margin.t,dragParallel:h?v:p,dragPerpendicular:h?p:v,arrangement:l.arrangement,sankey:a,graph:w,forceLayouts:{},interactionState:{dragInProgress:!1,hovered:!1}}}function k(t,e,n){var r=i(e.color),a=e.source.label+"|"+e.target.label+"__"+n;return e.trace=t.trace,e.curveNumber=t.trace.index,{circular:t.circular,key:a,traceId:t.key,pointNumber:e.pointNumber,link:e,tinyColorHue:o.tinyRGB(r),tinyColorAlpha:r.getAlpha(),linkPath:m,linkLineColor:t.linkLineColor,linkLineWidth:t.linkLineWidth,valueFormat:t.valueFormat,valueSuffix:t.valueSuffix,sankey:t.sankey,parent:t,interactionState:t.interactionState,flow:e.flow}}function m(){return function(t){if(t.link.circular)return n=(e=t.link).width/2,r=e.circularPathData,"top"===e.circularLinkType?"M "+r.targetX+" "+(r.targetY+n)+" L"+r.rightInnerExtent+" "+(r.targetY+n)+"A"+(r.rightLargeArcRadius+n)+" "+(r.rightSmallArcRadius+n)+" 0 0 1 "+(r.rightFullExtent-n)+" "+(r.targetY-r.rightSmallArcRadius)+"L"+(r.rightFullExtent-n)+" "+r.verticalRightInnerExtent+"A"+(r.rightLargeArcRadius+n)+" "+(r.rightLargeArcRadius+n)+" 0 0 1 "+r.rightInnerExtent+" "+(r.verticalFullExtent-n)+"L"+r.leftInnerExtent+" "+(r.verticalFullExtent-n)+"A"+(r.leftLargeArcRadius+n)+" "+(r.leftLargeArcRadius+n)+" 0 0 1 "+(r.leftFullExtent+n)+" "+r.verticalLeftInnerExtent+"L"+(r.leftFullExtent+n)+" "+(r.sourceY-r.leftSmallArcRadius)+"A"+(r.leftLargeArcRadius+n)+" "+(r.leftSmallArcRadius+n)+" 0 0 1 "+r.leftInnerExtent+" "+(r.sourceY+n)+"L"+r.sourceX+" "+(r.sourceY+n)+"L"+r.sourceX+" "+(r.sourceY-n)+"L"+r.leftInnerExtent+" "+(r.sourceY-n)+"A"+(r.leftLargeArcRadius-n)+" "+(r.leftSmallArcRadius-n)+" 0 0 0 "+(r.leftFullExtent-n)+" "+(r.sourceY-r.leftSmallArcRadius)+"L"+(r.leftFullExtent-n)+" "+r.verticalLeftInnerExtent+"A"+(r.leftLargeArcRadius-n)+" "+(r.leftLargeArcRadius-n)+" 0 0 0 "+r.leftInnerExtent+" "+(r.verticalFullExtent+n)+"L"+r.rightInnerExtent+" "+(r.verticalFullExtent+n)+"A"+(r.rightLargeArcRadius-n)+" "+(r.rightLargeArcRadius-n)+" 0 0 0 "+(r.rightFullExtent+n)+" "+r.verticalRightInnerExtent+"L"+(r.rightFullExtent+n)+" "+(r.targetY-r.rightSmallArcRadius)+"A"+(r.rightLargeArcRadius-n)+" "+(r.rightSmallArcRadius-n)+" 0 0 0 "+r.rightInnerExtent+" "+(r.targetY-n)+"L"+r.targetX+" "+(r.targetY-n)+"Z":"M "+r.targetX+" "+(r.targetY-n)+" L"+r.rightInnerExtent+" "+(r.targetY-n)+"A"+(r.rightLargeArcRadius+n)+" "+(r.rightSmallArcRadius+n)+" 0 0 0 "+(r.rightFullExtent-n)+" "+(r.targetY+r.rightSmallArcRadius)+"L"+(r.rightFullExtent-n)+" "+r.verticalRightInnerExtent+"A"+(r.rightLargeArcRadius+n)+" "+(r.rightLargeArcRadius+n)+" 0 0 0 "+r.rightInnerExtent+" "+(r.verticalFullExtent+n)+"L"+r.leftInnerExtent+" "+(r.verticalFullExtent+n)+"A"+(r.leftLargeArcRadius+n)+" "+(r.leftLargeArcRadius+n)+" 0 0 0 "+(r.leftFullExtent+n)+" "+r.verticalLeftInnerExtent+"L"+(r.leftFullExtent+n)+" "+(r.sourceY+r.leftSmallArcRadius)+"A"+(r.leftLargeArcRadius+n)+" "+(r.leftSmallArcRadius+n)+" 0 0 0 "+r.leftInnerExtent+" "+(r.sourceY-n)+"L"+r.sourceX+" "+(r.sourceY-n)+"L"+r.sourceX+" "+(r.sourceY+n)+"L"+r.leftInnerExtent+" "+(r.sourceY+n)+"A"+(r.leftLargeArcRadius-n)+" "+(r.leftSmallArcRadius-n)+" 0 0 1 "+(r.leftFullExtent-n)+" "+(r.sourceY+r.leftSmallArcRadius)+"L"+(r.leftFullExtent-n)+" "+r.verticalLeftInnerExtent+"A"+(r.leftLargeArcRadius-n)+" "+(r.leftLargeArcRadius-n)+" 0 0 1 "+r.leftInnerExtent+" "+(r.verticalFullExtent-n)+"L"+r.rightInnerExtent+" "+(r.verticalFullExtent-n)+"A"+(r.rightLargeArcRadius-n)+" "+(r.rightLargeArcRadius-n)+" 0 0 1 "+(r.rightFullExtent+n)+" "+r.verticalRightInnerExtent+"L"+(r.rightFullExtent+n)+" "+(r.targetY+r.rightSmallArcRadius)+"A"+(r.rightLargeArcRadius-n)+" "+(r.rightSmallArcRadius-n)+" 0 0 1 "+r.rightInnerExtent+" "+(r.targetY+n)+"L"+r.targetX+" "+(r.targetY+n)+"Z";var e,n,r,a=t.link.source.x1,i=t.link.target.x0,o=p(a,i),l=o(.5),c=o(.5),u=t.link.y0-t.link.width/2,s=t.link.y0+t.link.width/2,f=t.link.y1-t.link.width/2,h=t.link.y1+t.link.width/2;return"M"+a+","+u+"C"+l+","+u+" "+c+","+f+" "+i+","+f+"L"+i+","+h+"C"+c+","+h+" "+l+","+s+" "+a+","+s+"Z"}}function L(t,e){var n=i(e.color),a=r.nodePadAcross,l=t.nodePad/2;e.dx=e.x1-e.x0,e.dy=e.y1-e.y0;var c=e.dx,u=Math.max(.5,e.dy),s="node_"+e.pointNumber;return e.group&&(s=f.randstr()),e.trace=t.trace,e.curveNumber=t.trace.index,{index:e.pointNumber,key:s,partOfGroup:e.partOfGroup||!1,group:e.group,traceId:t.key,trace:t.trace,node:e,nodePad:t.nodePad,nodeLineColor:t.nodeLineColor,nodeLineWidth:t.nodeLineWidth,textFont:t.textFont,size:t.horizontal?t.height:t.width,visibleWidth:Math.ceil(c),visibleHeight:u,zoneX:-a,zoneY:-l,zoneWidth:c+2*a,zoneHeight:u+2*l,labelY:t.horizontal?e.dy/2+1:e.dx/2+1,left:1===e.originalLayer,sizeAcross:t.width,forceLayouts:t.forceLayouts,horizontal:t.horizontal,darkBackground:n.getBrightness()<=128,tinyColorHue:o.tinyRGB(n),tinyColorAlpha:n.getAlpha(),valueFormat:t.valueFormat,valueSuffix:t.valueSuffix,sankey:t.sankey,graph:t.graph,arrangement:t.arrangement,uniqueNodeLabelPathId:[t.guid,t.key,s].join("_"),interactionState:t.interactionState,figure:t}}function _(t){t.attr("transform",(function(t){return"translate("+t.node.x0.toFixed(3)+", "+t.node.y0.toFixed(3)+")"}))}function b(t){t.call(_)}function w(t,e){t.call(b),e.attr("d",m())}function A(t){t.attr("width",(function(t){return t.node.x1-t.node.x0})).attr("height",(function(t){return t.visibleHeight}))}function E(t){return t.link.width>1||t.linkLineWidth>0}function P(t){return"translate("+t.translateX+","+t.translateY+")"+(t.horizontal?"matrix(1 0 0 1 0 0)":"matrix(0 1 1 0 0 0)")}function D(t){return"translate("+(t.horizontal?0:t.labelY)+" "+(t.horizontal?t.labelY:0)+")"}function T(t){return a.svg.line()([[t.horizontal?t.left?-t.sizeAcross:t.visibleWidth+r.nodeTextOffsetHorizontal:r.nodeTextOffsetHorizontal,0],[t.horizontal?t.left?-r.nodeTextOffsetHorizontal:t.sizeAcross:t.visibleHeight-r.nodeTextOffsetHorizontal,0]])}function I(t){return t.horizontal?"matrix(1 0 0 1 0 0)":"matrix(0 1 1 0 0 0)"}function R(t){return t.horizontal?"scale(1 1)":"scale(-1 1)"}function S(t){return t.darkBackground&&!t.horizontal?"rgb(255,255,255)":"rgb(0,0,0)"}function N(t){return t.horizontal&&t.left?"100%":"0%"}function F(t,e,n){t.on(".basic",null).on("mouseover.basic",(function(t){t.interactionState.dragInProgress||t.partOfGroup||(n.hover(this,t,e),t.interactionState.hovered=[this,t])})).on("mousemove.basic",(function(t){t.interactionState.dragInProgress||t.partOfGroup||(n.follow(this,t),t.interactionState.hovered=[this,t])})).on("mouseout.basic",(function(t){t.interactionState.dragInProgress||t.partOfGroup||(n.unhover(this,t,e),t.interactionState.hovered=!1)})).on("click.basic",(function(t){t.interactionState.hovered&&(n.unhover(this,t,e),t.interactionState.hovered=!1),t.interactionState.dragInProgress||t.partOfGroup||n.select(this,t,e)}))}function M(t,e,n,i){var o=a.behavior.drag().origin((function(t){return{x:t.node.x0+t.visibleWidth/2,y:t.node.y0+t.visibleHeight/2}})).on("dragstart",(function(a){if("fixed"!==a.arrangement&&(f.ensureSingle(i._fullLayout._infolayer,"g","dragcover",(function(t){i._fullLayout._dragCover=t})),f.raiseToTop(this),a.interactionState.dragInProgress=a.node,O(a.node),a.interactionState.hovered&&(n.nodeEvents.unhover.apply(0,a.interactionState.hovered),a.interactionState.hovered=!1),"snap"===a.arrangement)){var o=a.traceId+"|"+a.key;a.forceLayouts[o]?a.forceLayouts[o].alpha(1):function(t,e,n,a){!function(t){for(var e=0;e<t.length;e++)t[e].y=(t[e].y0+t[e].y1)/2,t[e].x=(t[e].x0+t[e].x1)/2}(n.graph.nodes);var i=n.graph.nodes.filter((function(t){return t.originalX===n.node.originalX})).filter((function(t){return!t.partOfGroup}));n.forceLayouts[e]=s.forceSimulation(i).alphaDecay(0).force("collide",s.forceCollide().radius((function(t){return t.dy/2+n.nodePad/2})).strength(1).iterations(r.forceIterations)).force("constrain",function(t,e,n,a){return function(){for(var t=0,i=0;i<n.length;i++){var o=n[i];o===a.interactionState.dragInProgress?(o.x=o.lastDraggedX,o.y=o.lastDraggedY):(o.vx=(o.originalX-o.x)/r.forceTicksPerFrame,o.y=Math.min(a.size-o.dy/2,Math.max(o.dy/2,o.y))),t=Math.max(t,Math.abs(o.vx),Math.abs(o.vy))}!a.interactionState.dragInProgress&&t<.1&&a.forceLayouts[e].alpha()>0&&a.forceLayouts[e].alpha(0)}}(0,e,i,n)).stop()}(0,o,a),function(t,e,n,a,i){window.requestAnimationFrame((function o(){var l;for(l=0;l<r.forceTicksPerFrame;l++)n.forceLayouts[a].tick();if(function(t){for(var e=0;e<t.length;e++)t[e].y0=t[e].y-t[e].dy/2,t[e].y1=t[e].y0+t[e].dy,t[e].x0=t[e].x-t[e].dx/2,t[e].x1=t[e].x0+t[e].dx}(n.graph.nodes),n.sankey.update(n.graph),w(t.filter(z(n)),e),n.forceLayouts[a].alpha()>0)window.requestAnimationFrame(o);else{var c=n.node.originalX;n.node.x0=c-n.visibleWidth/2,n.node.x1=c+n.visibleWidth/2,C(n,i)}}))}(t,e,a,o,i)}})).on("drag",(function(n){if("fixed"!==n.arrangement){var r=a.event.x,i=a.event.y;"snap"===n.arrangement?(n.node.x0=r-n.visibleWidth/2,n.node.x1=r+n.visibleWidth/2,n.node.y0=i-n.visibleHeight/2,n.node.y1=i+n.visibleHeight/2):("freeform"===n.arrangement&&(n.node.x0=r-n.visibleWidth/2,n.node.x1=r+n.visibleWidth/2),i=Math.max(0,Math.min(n.size-n.visibleHeight/2,i)),n.node.y0=i-n.visibleHeight/2,n.node.y1=i+n.visibleHeight/2),O(n.node),"snap"!==n.arrangement&&(n.sankey.update(n.graph),w(t.filter(z(n)),e))}})).on("dragend",(function(t){if("fixed"!==t.arrangement){t.interactionState.dragInProgress=!1;for(var e=0;e<t.node.childrenNodes.length;e++)t.node.childrenNodes[e].x=t.node.x,t.node.childrenNodes[e].y=t.node.y;"snap"!==t.arrangement&&C(t,i)}}));t.on(".drag",null).call(o)}function C(t,e){for(var n=[],r=[],a=0;a<t.graph.nodes.length;a++){var i=(t.graph.nodes[a].x0+t.graph.nodes[a].x1)/2,o=(t.graph.nodes[a].y0+t.graph.nodes[a].y1)/2;n.push(i/t.figure.width),r.push(o/t.figure.height)}v.call("_guiRestyle",e,{"node.x":[n],"node.y":[r]},t.trace.index).then((function(){e._fullLayout._dragCover&&e._fullLayout._dragCover.remove()}))}function O(t){t.lastDraggedX=t.x0+t.dx/2,t.lastDraggedY=t.y0+t.dy/2}function z(t){return function(e){return e.node.originalX===t.node.originalX}}t.exports=function(t,e,n,c,u){var s=!1;f.ensureSingle(t._fullLayout._infolayer,"g","first-render",(function(){s=!0}));var h=t._fullLayout._dragCover,p=n.filter((function(t){return g(t).trace.visible})).map(x.bind(null,c)),v=e.selectAll("."+r.cn.sankey).data(p,d);v.exit().remove(),v.enter().append("g").classed(r.cn.sankey,!0).style("box-sizing","content-box").style("position","absolute").style("left",0).style("shape-rendering","geometricPrecision").style("pointer-events","auto").attr("transform",P),v.each((function(e,n){t._fullData[n]._sankey=e;var r="bgsankey-"+e.trace.uid+"-"+n;f.ensureSingle(t._fullLayout._draggers,"rect",r),t._fullData[n]._bgRect=a.select("."+r),t._fullData[n]._bgRect.style("pointer-events","all").attr("width",e.width).attr("height",e.height).attr("x",e.translateX).attr("y",e.translateY).classed("bgsankey",!0).style({fill:"transparent","stroke-width":0})})),v.transition().ease(r.ease).duration(r.duration).attr("transform",P);var b=v.selectAll("."+r.cn.sankeyLinks).data(y,d);b.enter().append("g").classed(r.cn.sankeyLinks,!0).style("fill","none");var w=b.selectAll("."+r.cn.sankeyLink).data((function(t){return t.graph.links.filter((function(t){return t.value})).map(k.bind(null,t))}),d);w.enter().append("path").classed(r.cn.sankeyLink,!0).call(F,v,u.linkEvents),w.style("stroke",(function(t){return E(t)?o.tinyRGB(i(t.linkLineColor)):t.tinyColorHue})).style("stroke-opacity",(function(t){return E(t)?o.opacity(t.linkLineColor):t.tinyColorAlpha})).style("fill",(function(t){return t.tinyColorHue})).style("fill-opacity",(function(t){return t.tinyColorAlpha})).style("stroke-width",(function(t){return E(t)?t.linkLineWidth:1})).attr("d",m()),w.style("opacity",(function(){return t._context.staticPlot||s||h?1:0})).transition().ease(r.ease).duration(r.duration).style("opacity",1),w.exit().transition().ease(r.ease).duration(r.duration).style("opacity",0).remove();var C=v.selectAll("."+r.cn.sankeyNodeSet).data(y,d);C.enter().append("g").classed(r.cn.sankeyNodeSet,!0),C.style("cursor",(function(t){switch(t.arrangement){case"fixed":return"default";case"perpendicular":return"ns-resize";default:return"move"}}));var O=C.selectAll("."+r.cn.sankeyNode).data((function(t){var e=t.graph.nodes;return function(t){var e,n=[];for(e=0;e<t.length;e++)t[e].originalX=(t[e].x0+t[e].x1)/2,t[e].originalY=(t[e].y0+t[e].y1)/2,-1===n.indexOf(t[e].originalX)&&n.push(t[e].originalX);for(n.sort((function(t,e){return t-e})),e=0;e<t.length;e++)t[e].originalLayerIndex=n.indexOf(t[e].originalX),t[e].originalLayer=t[e].originalLayerIndex/(n.length-1)}(e),e.map(L.bind(null,t))}),d);O.enter().append("g").classed(r.cn.sankeyNode,!0).call(_).style("opacity",(function(e){return!t._context.staticPlot&&!s||e.partOfGroup?0:1})),O.call(F,v,u.nodeEvents).call(M,w,u,t),O.transition().ease(r.ease).duration(r.duration).call(_).style("opacity",(function(t){return t.partOfGroup?0:1})),O.exit().transition().ease(r.ease).duration(r.duration).style("opacity",0).remove();var z=O.selectAll("."+r.cn.nodeRect).data(y);z.enter().append("rect").classed(r.cn.nodeRect,!0).call(A),z.style("stroke-width",(function(t){return t.nodeLineWidth})).style("stroke",(function(t){return o.tinyRGB(i(t.nodeLineColor))})).style("stroke-opacity",(function(t){return o.opacity(t.nodeLineColor)})).style("fill",(function(t){return t.tinyColorHue})).style("fill-opacity",(function(t){return t.tinyColorAlpha})),z.transition().ease(r.ease).duration(r.duration).call(A);var Y=O.selectAll("."+r.cn.nodeCapture).data(y);Y.enter().append("rect").classed(r.cn.nodeCapture,!0).style("fill-opacity",0),Y.attr("x",(function(t){return t.zoneX})).attr("y",(function(t){return t.zoneY})).attr("width",(function(t){return t.zoneWidth})).attr("height",(function(t){return t.zoneHeight}));var j=O.selectAll("."+r.cn.nodeCentered).data(y);j.enter().append("g").classed(r.cn.nodeCentered,!0).attr("transform",D),j.transition().ease(r.ease).duration(r.duration).attr("transform",D);var X=j.selectAll("."+r.cn.nodeLabelGuide).data(y);X.enter().append("path").classed(r.cn.nodeLabelGuide,!0).attr("id",(function(t){return t.uniqueNodeLabelPathId})).attr("d",T).attr("transform",I),X.transition().ease(r.ease).duration(r.duration).attr("d",T).attr("transform",I);var B=j.selectAll("."+r.cn.nodeLabel).data(y);B.enter().append("text").classed(r.cn.nodeLabel,!0).attr("transform",R).style("user-select","none").style("cursor","default").style("fill","black"),B.style("text-shadow",(function(t){return t.horizontal?"-1px 1px 1px #fff, 1px 1px 1px #fff, 1px -1px 1px #fff, -1px -1px 1px #fff":"none"})).each((function(t){l.font(B,t.textFont)})),B.transition().ease(r.ease).duration(r.duration).attr("transform",R);var q=B.selectAll("."+r.cn.nodeLabelTextPath).data(y);q.enter().append("textPath").classed(r.cn.nodeLabelTextPath,!0).attr("alignment-baseline","middle").attr("xlink:href",(function(t){return"#"+t.uniqueNodeLabelPathId})).attr("startOffset",N).style("fill",S),q.text((function(t){return t.horizontal||t.node.dy>5?t.node.label:""})).attr("text-anchor",(function(t){return t.horizontal&&t.left?"end":"start"})),q.transition().ease(r.ease).duration(r.duration).attr("startOffset",N).style("fill",S)}},47038:t=>{"use strict";t.exports=function(t,e){for(var n=[],r=t.cd[0].trace,a=r._sankey.graph.nodes,i=0;i<a.length;i++){var o=a[i];if(!o.partOfGroup){var l=[(o.x0+o.x1)/2,(o.y0+o.y1)/2];"v"===r.orientation&&l.reverse(),e&&e.contains(l,!1,i,t)&&n.push({pointNumber:o.pointNumber})}}return n}},52617:t=>{"use strict";t.exports=function(t){for(var e=t.length,n=new Array(e),r=new Array(e),a=new Array(e),i=new Array(e),o=new Array(e),l=new Array(e),c=0;c<e;++c)n[c]=-1,r[c]=0,a[c]=!1,i[c]=0,o[c]=-1,l[c]=[];var u,s=0,f=[],h=[];function d(e){var c=[e],u=[e];for(n[e]=r[e]=s,a[e]=!0,s+=1;u.length>0;){e=u[u.length-1];var d=t[e];if(i[e]<d.length){for(var y=i[e];y<d.length;++y){var g=d[y];if(n[g]<0){n[g]=r[g]=s,a[g]=!0,s+=1,c.push(g),u.push(g);break}a[g]&&(r[e]=0|Math.min(r[e],r[g])),o[g]>=0&&l[e].push(o[g])}i[e]=y}else{if(r[e]===n[e]){var p=[],v=[],x=0;for(y=c.length-1;y>=0;--y){var k=c[y];if(a[k]=!1,p.push(k),v.push(l[k]),x+=l[k].length,o[k]=f.length,k===e){c.length=y;break}}f.push(p);var m=new Array(x);for(y=0;y<v.length;y++)for(var L=0;L<v[y].length;L++)m[--x]=v[y][L];h.push(m)}u.pop()}}}for(c=0;c<e;++c)n[c]<0&&d(c);for(c=0;c<h.length;c++){var y=h[c];if(0!==y.length){y.sort((function(t,e){return t-e})),u=[y[0]];for(var g=1;g<y.length;g++)y[g]!==y[g-1]&&u.push(y[g]);h[c]=u}}return{components:f,adjacencyList:h}}}}]);